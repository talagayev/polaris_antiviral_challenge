{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f3e51057-9432-4574-9ee5-69760ecd806d",
   "metadata": {},
   "source": [
    "# Ligand ADMET and Potency (Property Prediction)\n",
    "\n",
    "The [ADMET](https://polarishub.io/competitions/asap-discovery/antiviral-admet-2025) and [Potency](https://polarishub.io/competitions/asap-discovery/antiviral-potency-2025) Challenge of the [ASAP Discovery competition](https://polarishub.io/blog/antiviral-competition) take the shape of a property prediction task. Given the SMILES (or, to be more precise, the CXSMILES) of a molecule, you are asked to predict the numerical properties of said molecule. This is a relatively straight-forward application of ML and this notebook will quickly get you up and running!\n",
    "\n",
    "To begin with, choose one of the two challenges! The code will look the same for both. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1a602a63-c1ac-4367-afd9-98ba3cc1850e",
   "metadata": {},
   "outputs": [],
   "source": [
    "import polaris as po\n",
    "from polaris.hub.client import PolarisHubClient\n",
    "import csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d8d57b0e-2f15-4a81-b832-c7d9f547a7ec",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[2025-02-07 15:27:21] </span><span style=\"color: #000080; text-decoration-color: #000080\">INFO    </span> You are successfully logged in to the Polaris Hub.                     <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/hub/client.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">client.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/hub/client.py#252\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">252</span></a>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m[2025-02-07 15:27:21]\u001b[0m\u001b[2;36m \u001b[0m\u001b[34mINFO    \u001b[0m You are successfully logged in to the Polaris Hub.                     \u001b]8;id=951562;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/hub/client.py\u001b\\\u001b[2mclient.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=182094;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/hub/client.py#252\u001b\\\u001b[2m252\u001b[0m\u001b]8;;\u001b\\\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "client = PolarisHubClient()\n",
    "client.login()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c1e1f5a4-d7b4-41cc-a5fc-a657ca5fd6cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "CHALLENGE = \"antiviral-potency-2025\"  # or: \"antiviral-potency-2025\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2319bfb8-1fef-4294-a8f6-a225b7a95c09",
   "metadata": {},
   "source": [
    "## Load the competition\n",
    "\n",
    "Let's first load the competition from Polaris.\n",
    "\n",
    "Make sure you are logged in! If not, simply run `polaris login` and follow the instructions. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "0a466c50-5408-4f72-840c-b467ca5f0f3f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[2025-02-07 15:27:23] </span><span style=\"color: #000080; text-decoration-color: #000080\">INFO    </span> The version of Polaris that was used to create the artifact <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.11</span>.<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0</span><span style=\"font-weight: bold\">)</span> <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/_artifact.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">_artifact.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/_artifact.py#92\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">92</span></a>\n",
       "<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">                      </span>         is different from the currently installed version of Polaris         <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">               </span>\n",
       "<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">                      </span>         <span style=\"font-weight: bold\">(</span><span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">0.11</span>.<span style=\"color: #008080; text-decoration-color: #008080; font-weight: bold\">5</span><span style=\"font-weight: bold\">)</span>.                                                            <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">               </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m[2025-02-07 15:27:23]\u001b[0m\u001b[2;36m \u001b[0m\u001b[34mINFO    \u001b[0m The version of Polaris that was used to create the artifact \u001b[1m(\u001b[0m\u001b[1;36m0.11\u001b[0m.\u001b[1;36m0\u001b[0m\u001b[1m)\u001b[0m \u001b]8;id=802859;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/_artifact.py\u001b\\\u001b[2m_artifact.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=419865;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/_artifact.py#92\u001b\\\u001b[2m92\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[2;36m                      \u001b[0m         is different from the currently installed version of Polaris         \u001b[2m               \u001b[0m\n",
       "\u001b[2;36m                      \u001b[0m         \u001b[1m(\u001b[0m\u001b[1;36m0.11\u001b[0m.\u001b[1;36m5\u001b[0m\u001b[1m)\u001b[0m.                                                            \u001b[2m               \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">                      </span><span style=\"color: #808000; text-decoration-color: #808000\">WARNING </span> You're loading data from a remote location. If the dataset is small     <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">_base.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#182\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">182</span></a>\n",
       "<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">                      </span>         enough, consider caching the dataset first using                        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">            </span>\n",
       "<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">                      </span>         <span style=\"color: #800080; text-decoration-color: #800080; font-weight: bold\">CompetitionSpecification.cache</span><span style=\"font-weight: bold\">()</span> for more performant data access.       <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">            </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m                     \u001b[0m\u001b[2;36m \u001b[0m\u001b[33mWARNING \u001b[0m You're loading data from a remote location. If the dataset is small     \u001b]8;id=841893;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\u001b\\\u001b[2m_base.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=457841;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#182\u001b\\\u001b[2m182\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[2;36m                      \u001b[0m         enough, consider caching the dataset first using                        \u001b[2m            \u001b[0m\n",
       "\u001b[2;36m                      \u001b[0m         \u001b[1;35mCompetitionSpecification.cache\u001b[0m\u001b[1m(\u001b[0m\u001b[1m)\u001b[0m for more performant data access.       \u001b[2m            \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import polaris as po\n",
    "\n",
    "competition = po.load_competition(f\"asap-discovery/{CHALLENGE}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5478ab20-ed4b-4f7d-a5bb-3618748de65a",
   "metadata": {},
   "source": [
    "As suggested in the logs, we'll cache the dataset. Note that this is not strictly necessary, but it does speed up later steps."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d44d7a37-2119-42cd-a7eb-41daf5687660",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "e253755619b143cdacee20afc55ab079",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Output()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[15:27:24] </span><span style=\"color: #008000; text-decoration-color: #008000\">Copying to destination </span>                                                                     <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">_base.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#381\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">381</span></a>\n",
       "<span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span><span style=\"color: #008000; text-decoration-color: #008000\">/home/valerij/.cache/polaris/datasets/d04266f9-7493-4fd1-b0a1-e6e9c22c251f/data.zarr</span>        <span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">            </span>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m[15:27:24]\u001b[0m\u001b[2;36m \u001b[0m\u001b[32mCopying to destination \u001b[0m                                                                     \u001b]8;id=120087;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\u001b\\\u001b[2m_base.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=992640;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#381\u001b\\\u001b[2m381\u001b[0m\u001b]8;;\u001b\\\n",
       "\u001b[2;36m           \u001b[0m\u001b[32m/home/valerij/.cache/polaris/datasets/d04266f9-7493-4fd1-b0a1-e6e9c22c251f/\u001b[0m\u001b[32mdata.zarr\u001b[0m        \u001b[2m            \u001b[0m\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span><span style=\"color: #808000; text-decoration-color: #808000\">For large Zarr archives, this may take a while.</span>                                             <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">_base.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#382\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">382</span></a>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0m\u001b[33mFor large Zarr archives, this may take a while.\u001b[0m                                             \u001b]8;id=653687;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py\u001b\\\u001b[2m_base.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=359047;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/dataset/_base.py#382\u001b\\\u001b[2m382\u001b[0m\u001b]8;;\u001b\\\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">[15:27:25] </span><span style=\"color: #008000; text-decoration-color: #008000\"> Success: Copying Zarr keys</span>                                                                <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">context.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py#53\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">53</span></a>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m[15:27:25]\u001b[0m\u001b[2;36m \u001b[0m\u001b[32m Success: Copying Zarr keys\u001b[0m                                                                \u001b]8;id=565432;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py\u001b\\\u001b[2mcontext.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=195310;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py#53\u001b\\\u001b[2m53\u001b[0m\u001b]8;;\u001b\\\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"color: #7fbfbf; text-decoration-color: #7fbfbf\">           </span><span style=\"color: #008000; text-decoration-color: #008000\"> Success: Copying Zarr archive</span>                                                             <a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">context.py</span></a><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">:</span><a href=\"file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py#53\" target=\"_blank\"><span style=\"color: #7f7f7f; text-decoration-color: #7f7f7f\">53</span></a>\n",
       "</pre>\n"
      ],
      "text/plain": [
       "\u001b[2;36m          \u001b[0m\u001b[2;36m \u001b[0m\u001b[32m Success: Copying Zarr archive\u001b[0m                                                             \u001b]8;id=170197;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py\u001b\\\u001b[2mcontext.py\u001b[0m\u001b]8;;\u001b\\\u001b[2m:\u001b[0m\u001b]8;id=351971;file:///home/valerij/miniconda3/envs/pol/lib/python3.12/site-packages/polaris/utils/context.py#53\u001b\\\u001b[2m53\u001b[0m\u001b]8;;\u001b\\\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"></pre>\n"
      ],
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "'/home/valerij/.cache/polaris/datasets/d04266f9-7493-4fd1-b0a1-e6e9c22c251f'"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "competition.cache()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2455a1a-ef57-4e04-9d0c-47553c5e8059",
   "metadata": {},
   "source": [
    "Let's get the train and test set and take a look at the data structure."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "46c34cf4-31fd-4de1-8b18-0694a2a25d29",
   "metadata": {},
   "outputs": [],
   "source": [
    "train, test = competition.get_train_test_split()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "dfa8d6c9-7274-4a30-937a-08e7a87974ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "('CN1C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)C12CN(S(C)(=O)=O)C2',\n",
       " {'pIC50 (MERS-CoV Mpro)': 4.69, 'pIC50 (SARS-CoV-2 Mpro)': nan})"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "9af20948-ad7c-4ff8-9f36-152a5d0440f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'polaris.dataset._subset.Subset'>\n"
     ]
    }
   ],
   "source": [
    "print(type(train))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "3d05848d-d6cd-4f75-bc1f-a6c31206596c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array(['COC[C@]1(C)C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)N1C |&1:3|'],\n",
       "       dtype=object),\n",
       " {'pIC50 (MERS-CoV Mpro)': array([4.19]),\n",
       "  'pIC50 (SARS-CoV-2 Mpro)': array([nan])})"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train[:1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1648a6d6-ab19-4de1-ac46-1c9cc42dd499",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "\n",
    "smiles_list_test = []\n",
    "\n",
    "# Iterate through train and populate the lists\n",
    "for t in test:\n",
    "    smiles_list_test.append(t)\n",
    "\n",
    "# Create the DataFrame\n",
    "potency_df_test = pd.DataFrame({\n",
    "    'SMILES': smiles_list_test,\n",
    "})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "20f5f947-a6c3-43cf-a4e5-824f44c11892",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SMILES</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>C=CC(=O)NC1=CC=CC(N(CC2=CC=CC(Cl)=C2)C(=O)CC2=...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CNC(=O)CN1C[C@]2(CCN(C3=CN=CC4=CC=C(OC[C@H](O)...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>O=C(CC1=CN=CC2=CC=CC=C12)N1CCCC[C@H]1[C@H]1CCC...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>O=C(CC1=CN=CC2=CC=CC=C12)N1CCCC[C@H]1[C@H]1CCC...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>O=C(CC1=CN=CC2=CC=CC=C12)N1CCC[C@H]2CCCC[C@@H]...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>COC1=CC=CC=C1[C@H]1C[C@H](C)CCN1C(=O)CC1=CN=CC...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>COC1=CC=CC=C1[C@H]1C[C@H](C)CCN1C(=O)CC1=CN=CC...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>297 rows × 1 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                SMILES\n",
       "0    C=CC(=O)NC1=CC=CC(N(CC2=CC=CC(Cl)=C2)C(=O)CC2=...\n",
       "1    CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...\n",
       "2    CNC(=O)CN1C[C@]2(CCN(C3=CN=CC4=CC=C(OC[C@H](O)...\n",
       "3    CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...\n",
       "4    CNC(=O)CN1C[C@@]2(C(=O)N(C3=CN=CC4=CC=CC=C34)C...\n",
       "..                                                 ...\n",
       "292  O=C(CC1=CN=CC2=CC=CC=C12)N1CCCC[C@H]1[C@H]1CCC...\n",
       "293  O=C(CC1=CN=CC2=CC=CC=C12)N1CCCC[C@H]1[C@H]1CCC...\n",
       "294  O=C(CC1=CN=CC2=CC=CC=C12)N1CCC[C@H]2CCCC[C@@H]...\n",
       "295  COC1=CC=CC=C1[C@H]1C[C@H](C)CCN1C(=O)CC1=CN=CC...\n",
       "296  COC1=CC=CC=C1[C@H]1C[C@H](C)CCN1C(=O)CC1=CN=CC...\n",
       "\n",
       "[297 rows x 1 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "potency_df_test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "b86714ce-db7e-409f-bc79-7fe4ab43ab80",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                                                 SMILES  \\\n",
      "0     COC[C@]1(C)C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)N1C...   \n",
      "1     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...   \n",
      "2     CNC(=O)CN1C[C@]2(C[C@H](C)N(C3=CN=CC=C3C3CC3)C...   \n",
      "3     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...   \n",
      "4     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...   \n",
      "...                                                 ...   \n",
      "1026  CNS(=O)(=O)OCC(=O)N1CCN(CC2=CC=CC(Cl)=C2)[C@H]...   \n",
      "1027  O=C(CC1=CN=CC2=CC=CC=C12)N1CC[C@@H]2CCCC[C@H]2...   \n",
      "1028  CNC(=O)[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...   \n",
      "1029  C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)[C@H]1C ...   \n",
      "1030  O=C(O)C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...   \n",
      "\n",
      "      pIC50 (SARS-CoV-2 Mpro)  \n",
      "0                         NaN  \n",
      "1                        5.29  \n",
      "2                         NaN  \n",
      "3                        6.11  \n",
      "4                        5.62  \n",
      "...                       ...  \n",
      "1026                     6.38  \n",
      "1027                     6.09  \n",
      "1028                      NaN  \n",
      "1029                     5.06  \n",
      "1030                      NaN  \n",
      "\n",
      "[1031 rows x 2 columns]\n",
      "                                                 SMILES  pIC50 (MERS-CoV Mpro)\n",
      "0     COC[C@]1(C)C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)N1C...                   4.19\n",
      "1     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.92\n",
      "2     CNC(=O)CN1C[C@]2(C[C@H](C)N(C3=CN=CC=C3C3CC3)C...                   4.73\n",
      "3     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.90\n",
      "4     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.81\n",
      "...                                                 ...                    ...\n",
      "1026  CNS(=O)(=O)OCC(=O)N1CCN(CC2=CC=CC(Cl)=C2)[C@H]...                   5.57\n",
      "1027  O=C(CC1=CN=CC2=CC=CC=C12)N1CC[C@@H]2CCCC[C@H]2...                   4.60\n",
      "1028  CNC(=O)[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...                   4.22\n",
      "1029  C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)[C@H]1C ...                   4.40\n",
      "1030  O=C(O)C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...                   4.22\n",
      "\n",
      "[1031 rows x 2 columns]\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "# Initialize lists to hold data for DataFrame\n",
    "smiles_list = []\n",
    "sars_list = []\n",
    "mers_list = []\n",
    "\n",
    "# Iterate through train and populate the lists\n",
    "for t in train:\n",
    "    smiles_list.append(t[0])\n",
    "    sars_list.append(t[1].get('pIC50 (SARS-CoV-2 Mpro)', None))\n",
    "    mers_list.append(t[1].get('pIC50 (MERS-CoV Mpro)', None))\n",
    "\n",
    "# Create the DataFrame\n",
    "potency_df_sars = pd.DataFrame({\n",
    "    'SMILES': smiles_list,\n",
    "    'pIC50 (SARS-CoV-2 Mpro)': sars_list,\n",
    "})\n",
    "\n",
    "# Create the DataFrame\n",
    "potency_df_mers = pd.DataFrame({\n",
    "    'SMILES': smiles_list,\n",
    "    'pIC50 (MERS-CoV Mpro)': mers_list,\n",
    "})\n",
    "\n",
    "# Display the DataFrame\n",
    "print(potency_df_sars)\n",
    "print(potency_df_mers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "906c9f3a-21af-4da3-892c-97b6a4b56071",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1031\n"
     ]
    }
   ],
   "source": [
    "print(len(train))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "ec22ca4b-395b-407f-93e6-2879a6d18004",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "297\n"
     ]
    }
   ],
   "source": [
    "print(len(test))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fa187b6a-65ad-42aa-9d9a-0c853e419cb0",
   "metadata": {},
   "source": [
    "### Raw data dump\n",
    "We've decided to sacrifice the completeness of the scientific data to improve its ease of use. For those that are interested, you can also access the raw data dump that this dataset has been created from."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6701ce16-bcaa-41f4-b1c9-0318c1720434",
   "metadata": {},
   "source": [
    "## Build a model\n",
    "Next, we'll train a simple baseline model using scikit-learn. \n",
    "\n",
    "You'll notice that the challenge has multiple targets."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "887b1afc-fb80-44e0-8662-c2535d02a85f",
   "metadata": {},
   "outputs": [],
   "source": [
    "from qsprpred.data import QSPRDataset\n",
    "from sklearn.impute import SimpleImputer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "a11b8832-c988-4d13-a856-2a78ab8ea373",
   "metadata": {},
   "outputs": [],
   "source": [
    "mers_props = [\n",
    "    {\"name\": \"pIC50 (MERS-CoV Mpro)\", \"task\": \"REGRESSION\"},]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7c2dc83a-4650-4f31-90a2-ee8a536112c1",
   "metadata": {},
   "source": [
    "## MERS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3743eb88-cbb7-4006-be72-42e13fa86cc3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SMILES</th>\n",
       "      <th>pIC50 (MERS-CoV Mpro)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>COC[C@]1(C)C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)N1C...</td>\n",
       "      <td>4.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...</td>\n",
       "      <td>4.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CNC(=O)CN1C[C@]2(C[C@H](C)N(C3=CN=CC=C3C3CC3)C...</td>\n",
       "      <td>4.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...</td>\n",
       "      <td>4.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...</td>\n",
       "      <td>4.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1026</th>\n",
       "      <td>CNS(=O)(=O)OCC(=O)N1CCN(CC2=CC=CC(Cl)=C2)[C@H]...</td>\n",
       "      <td>5.57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1027</th>\n",
       "      <td>O=C(CC1=CN=CC2=CC=CC=C12)N1CC[C@@H]2CCCC[C@H]2...</td>\n",
       "      <td>4.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028</th>\n",
       "      <td>CNC(=O)[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...</td>\n",
       "      <td>4.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1029</th>\n",
       "      <td>C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)[C@H]1C ...</td>\n",
       "      <td>4.40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1030</th>\n",
       "      <td>O=C(O)C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...</td>\n",
       "      <td>4.22</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1031 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 SMILES  pIC50 (MERS-CoV Mpro)\n",
       "0     COC[C@]1(C)C(=O)N(C2=CN=CC3=CC=CC=C23)C(=O)N1C...                   4.19\n",
       "1     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.92\n",
       "2     CNC(=O)CN1C[C@]2(C[C@H](C)N(C3=CN=CC=C3C3CC3)C...                   4.73\n",
       "3     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.90\n",
       "4     C=C(CN1CCC2=C(C=C(Cl)C=C2)C1C(=O)NC1=CN=CC2=CC...                   4.81\n",
       "...                                                 ...                    ...\n",
       "1026  CNS(=O)(=O)OCC(=O)N1CCN(CC2=CC=CC(Cl)=C2)[C@H]...                   5.57\n",
       "1027  O=C(CC1=CN=CC2=CC=CC=C12)N1CC[C@@H]2CCCC[C@H]2...                   4.60\n",
       "1028  CNC(=O)[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...                   4.22\n",
       "1029  C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)[C@H]1C ...                   4.40\n",
       "1030  O=C(O)C[C@H]1CCCN(C(=O)CC2=CN=CC3=CC=CC=C23)C1...                   4.22\n",
       "\n",
       "[1031 rows x 2 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "potency_df_mers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "bba28e43-aba4-4163-ac9c-6c305dd92ef0",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "qsprpred - WARNING - Existing data set found, but also found a data frame in store. Refusing to overwrite data. If you want to overwrite data in store, set overwrite=True.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SMILES</th>\n",
       "      <th>pIC50 (MERS-CoV Mpro)</th>\n",
       "      <th>QSPRID</th>\n",
       "      <th>pIC50 (MERS-CoV Mpro)_original</th>\n",
       "      <th>Split_IsTrain</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>QSPRID</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_0000</th>\n",
       "      <td>COC[C@]1(C)C(=O)N(c2cncc3ccccc23)C(=O)N1C</td>\n",
       "      <td>4.19</td>\n",
       "      <td>MultiTaskTutorialDataset_0000</td>\n",
       "      <td>4.19</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_0001</th>\n",
       "      <td>C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...</td>\n",
       "      <td>4.92</td>\n",
       "      <td>MultiTaskTutorialDataset_0001</td>\n",
       "      <td>4.92</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_0002</th>\n",
       "      <td>CNC(=O)CN1C[C@]2(C[C@H](C)N(c3cnccc3C3CC3)C2=O...</td>\n",
       "      <td>4.73</td>\n",
       "      <td>MultiTaskTutorialDataset_0002</td>\n",
       "      <td>4.73</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_0003</th>\n",
       "      <td>C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...</td>\n",
       "      <td>4.90</td>\n",
       "      <td>MultiTaskTutorialDataset_0003</td>\n",
       "      <td>4.90</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_0004</th>\n",
       "      <td>C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...</td>\n",
       "      <td>4.81</td>\n",
       "      <td>MultiTaskTutorialDataset_0004</td>\n",
       "      <td>4.81</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_1026</th>\n",
       "      <td>CNS(=O)(=O)OCC(=O)N1CCN(Cc2cccc(Cl)c2)[C@H]2CS...</td>\n",
       "      <td>5.57</td>\n",
       "      <td>MultiTaskTutorialDataset_1026</td>\n",
       "      <td>5.57</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_1027</th>\n",
       "      <td>O=C(Cc1cncc2ccccc12)N1CC[C@@H]2CCCC[C@H]2C1</td>\n",
       "      <td>4.60</td>\n",
       "      <td>MultiTaskTutorialDataset_1027</td>\n",
       "      <td>4.60</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_1028</th>\n",
       "      <td>CNC(=O)[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)C1</td>\n",
       "      <td>4.22</td>\n",
       "      <td>MultiTaskTutorialDataset_1028</td>\n",
       "      <td>4.22</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_1029</th>\n",
       "      <td>C[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)[C@H]1C</td>\n",
       "      <td>4.40</td>\n",
       "      <td>MultiTaskTutorialDataset_1029</td>\n",
       "      <td>4.40</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>MultiTaskTutorialDataset_1030</th>\n",
       "      <td>O=C(O)C[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)C1</td>\n",
       "      <td>4.22</td>\n",
       "      <td>MultiTaskTutorialDataset_1030</td>\n",
       "      <td>4.22</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>901 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                          SMILES  \\\n",
       "QSPRID                                                                             \n",
       "MultiTaskTutorialDataset_0000          COC[C@]1(C)C(=O)N(c2cncc3ccccc23)C(=O)N1C   \n",
       "MultiTaskTutorialDataset_0001  C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...   \n",
       "MultiTaskTutorialDataset_0002  CNC(=O)CN1C[C@]2(C[C@H](C)N(c3cnccc3C3CC3)C2=O...   \n",
       "MultiTaskTutorialDataset_0003  C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...   \n",
       "MultiTaskTutorialDataset_0004  C=C(CN1CCc2ccc(Cl)cc2C1C(=O)Nc1cncc2ccccc12)C(...   \n",
       "...                                                                          ...   \n",
       "MultiTaskTutorialDataset_1026  CNS(=O)(=O)OCC(=O)N1CCN(Cc2cccc(Cl)c2)[C@H]2CS...   \n",
       "MultiTaskTutorialDataset_1027        O=C(Cc1cncc2ccccc12)N1CC[C@@H]2CCCC[C@H]2C1   \n",
       "MultiTaskTutorialDataset_1028          CNC(=O)[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)C1   \n",
       "MultiTaskTutorialDataset_1029           C[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)[C@H]1C   \n",
       "MultiTaskTutorialDataset_1030          O=C(O)C[C@H]1CCCN(C(=O)Cc2cncc3ccccc23)C1   \n",
       "\n",
       "                               pIC50 (MERS-CoV Mpro)  \\\n",
       "QSPRID                                                 \n",
       "MultiTaskTutorialDataset_0000                   4.19   \n",
       "MultiTaskTutorialDataset_0001                   4.92   \n",
       "MultiTaskTutorialDataset_0002                   4.73   \n",
       "MultiTaskTutorialDataset_0003                   4.90   \n",
       "MultiTaskTutorialDataset_0004                   4.81   \n",
       "...                                              ...   \n",
       "MultiTaskTutorialDataset_1026                   5.57   \n",
       "MultiTaskTutorialDataset_1027                   4.60   \n",
       "MultiTaskTutorialDataset_1028                   4.22   \n",
       "MultiTaskTutorialDataset_1029                   4.40   \n",
       "MultiTaskTutorialDataset_1030                   4.22   \n",
       "\n",
       "                                                      QSPRID  \\\n",
       "QSPRID                                                         \n",
       "MultiTaskTutorialDataset_0000  MultiTaskTutorialDataset_0000   \n",
       "MultiTaskTutorialDataset_0001  MultiTaskTutorialDataset_0001   \n",
       "MultiTaskTutorialDataset_0002  MultiTaskTutorialDataset_0002   \n",
       "MultiTaskTutorialDataset_0003  MultiTaskTutorialDataset_0003   \n",
       "MultiTaskTutorialDataset_0004  MultiTaskTutorialDataset_0004   \n",
       "...                                                      ...   \n",
       "MultiTaskTutorialDataset_1026  MultiTaskTutorialDataset_1026   \n",
       "MultiTaskTutorialDataset_1027  MultiTaskTutorialDataset_1027   \n",
       "MultiTaskTutorialDataset_1028  MultiTaskTutorialDataset_1028   \n",
       "MultiTaskTutorialDataset_1029  MultiTaskTutorialDataset_1029   \n",
       "MultiTaskTutorialDataset_1030  MultiTaskTutorialDataset_1030   \n",
       "\n",
       "                               pIC50 (MERS-CoV Mpro)_original  Split_IsTrain  \n",
       "QSPRID                                                                        \n",
       "MultiTaskTutorialDataset_0000                            4.19           True  \n",
       "MultiTaskTutorialDataset_0001                            4.92           True  \n",
       "MultiTaskTutorialDataset_0002                            4.73           True  \n",
       "MultiTaskTutorialDataset_0003                            4.90           True  \n",
       "MultiTaskTutorialDataset_0004                            4.81           True  \n",
       "...                                                       ...            ...  \n",
       "MultiTaskTutorialDataset_1026                            5.57           True  \n",
       "MultiTaskTutorialDataset_1027                            4.60           True  \n",
       "MultiTaskTutorialDataset_1028                            4.22           True  \n",
       "MultiTaskTutorialDataset_1029                            4.40           True  \n",
       "MultiTaskTutorialDataset_1030                            4.22           True  \n",
       "\n",
       "[901 rows x 5 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataset_mers = QSPRDataset(\n",
    "    name=\"MultiTaskTutorialDataset\",\n",
    "    df=potency_df_mers,\n",
    "    target_props=mers_props,\n",
    "    store_dir=\"mers_output_adjusted/data\",\n",
    "    random_state=42,\n",
    ")\n",
    "\n",
    "dataset_mers.getDF()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "0eac6705-075e-47e6-b791-c2558a580ec9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of samples train set: 721\n",
      "Number of samples test set: 180\n"
     ]
    }
   ],
   "source": [
    "from qsprpred.data import RandomSplit, BootstrapSplit, ScaffoldSplit, ClusterSplit\n",
    "from qsprpred.data.descriptors.fingerprints import MorganFP, RDKitFP\n",
    "from qsprpred.data.processing.feature_filters import LowVarianceFilter\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "# Specifiy random split for creating the train (80%) and test set (20%)\n",
    "rand_split = ClusterSplit(test_fraction=0.2, dataset=dataset_mers)\n",
    "# rand_split = RandomSplit(test_fraction=0.15, dataset=dataset_mers)\n",
    "\n",
    "# calculate compound features and split dataset into train and test\n",
    "dataset_mers.prepareDataset(\n",
    "    split=rand_split,\n",
    "    feature_calculators=[MorganFP(radius=3, nBits=1024), RDKitFP(maxPath=7, nBits=512)],\n",
    "    recalculate_features=True,\n",
    "    feature_filters=[LowVarianceFilter(0.001)],\n",
    "    feature_standardizer=StandardScaler()\n",
    ")\n",
    "\n",
    "print(f\"Number of samples train set: {len(dataset_mers.y)}\")\n",
    "print(f\"Number of samples test set: {len(dataset_mers.y_ind)}\")\n",
    "\n",
    "dataset_mers.save()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a267e0bd-9692-47ef-90d8-1a115088a069",
   "metadata": {},
   "outputs": [],
   "source": [
    "from qsprpred.models import SklearnModel\n",
    "import os\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from xgboost import XGBClassifier, XGBRegressor\n",
    "from qsprpred.models import CrossValAssessor, TestSetAssessor\n",
    "\n",
    "os.makedirs(\"class_models/XG_models_clust\", exist_ok=True)\n",
    "\n",
    "# This is an SKlearn model, so we will initialize it with the SklearnModel class\n",
    "model_mers = SklearnModel(\n",
    "    base_dir=\"class_models/XG_models_clust_mers_adjusted\",\n",
    "    alg=XGBRegressor,\n",
    "    name=\"XGMorgan_clustsplit\"\n",
    ")\n",
    "\n",
    "import numpy as np\n",
    "from qsprpred.models import GridSearchOptimization, CrossValAssessor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "e1aca03c-ebde-42ef-bf0e-b98af582cc7b",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[I 2025-02-07 15:28:16,151] A new study created in memory with name: no-name-28c37ca0-c6df-4ffa-9435-4e648c0def1e\n",
      "[I 2025-02-07 15:28:16,465] Trial 0 finished with value: 0.0395191437115342 and parameters: {'max_depth': 8, 'gamma': 19, 'max_delta_step': 15, 'min_child_weight': 12, 'learning_rate': 0.1568626218019941, 'subsample': 0.15683852581586644, 'n_estimators': 23}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:16,624] Trial 1 finished with value: -0.203632929744739 and parameters: {'max_depth': 18, 'gamma': 12, 'max_delta_step': 14, 'min_child_weight': 1, 'learning_rate': 0.9699399423098324, 'subsample': 0.8326101981596213, 'n_estimators': 61}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:16,920] Trial 2 finished with value: -0.08177786666915665 and parameters: {'max_depth': 4, 'gamma': 3, 'max_delta_step': 6, 'min_child_weight': 11, 'learning_rate': 0.43251307362347363, 'subsample': 0.2919379110578439, 'n_estimators': 157}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:17,156] Trial 3 finished with value: -0.5932398439319324 and parameters: {'max_depth': 3, 'gamma': 6, 'max_delta_step': 7, 'min_child_weight': 10, 'learning_rate': 0.7853907854316206, 'subsample': 0.2004741083762014, 'n_estimators': 133}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:18,056] Trial 4 finished with value: -0.15895243907303103 and parameters: {'max_depth': 12, 'gamma': 0, 'max_delta_step': 12, 'min_child_weight': 4, 'learning_rate': 0.06598654139229423, 'subsample': 0.9489366517160799, 'n_estimators': 242}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:18,288] Trial 5 finished with value: -0.037595131176821894 and parameters: {'max_depth': 17, 'gamma': 6, 'max_delta_step': 2, 'min_child_weight': 14, 'learning_rate': 0.4407123412458617, 'subsample': 0.12291619660993405, 'n_estimators': 129}. Best is trial 0 with value: 0.0395191437115342.\n",
      "[I 2025-02-07 15:28:18,629] Trial 6 finished with value: 0.1005269203017447 and parameters: {'max_depth': 1, 'gamma': 19, 'max_delta_step': 5, 'min_child_weight': 14, 'learning_rate': 0.31239936501332155, 'subsample': 0.520547953156633, 'n_estimators': 141}. Best is trial 6 with value: 0.1005269203017447.\n",
      "[I 2025-02-07 15:28:18,932] Trial 7 finished with value: -0.10673991692190743 and parameters: {'max_depth': 4, 'gamma': 20, 'max_delta_step': 16, 'min_child_weight': 19, 'learning_rate': 0.8949325230772212, 'subsample': 0.598302078832274, 'n_estimators': 232}. Best is trial 6 with value: 0.1005269203017447.\n",
      "[I 2025-02-07 15:28:19,228] Trial 8 finished with value: -0.2115421853945434 and parameters: {'max_depth': 2, 'gamma': 4, 'max_delta_step': 0, 'min_child_weight': 7, 'learning_rate': 0.3892886123997925, 'subsample': 0.272077682742122, 'n_estimators': 209}. Best is trial 6 with value: 0.1005269203017447.\n",
      "[I 2025-02-07 15:28:19,829] Trial 9 finished with value: -4111.508924079037 and parameters: {'max_depth': 8, 'gamma': 5, 'max_delta_step': 11, 'min_child_weight': 3, 'learning_rate': 0.8023947837732857, 'subsample': 0.07547609303609105, 'n_estimators': 247}. Best is trial 6 with value: 0.1005269203017447.\n",
      "[I 2025-02-07 15:28:20,040] Trial 10 finished with value: 0.12435760963066189 and parameters: {'max_depth': 11, 'gamma': 14, 'max_delta_step': 20, 'min_child_weight': 18, 'learning_rate': 0.2734141903238835, 'subsample': 0.5414029642673724, 'n_estimators': 97}. Best is trial 10 with value: 0.12435760963066189.\n",
      "[I 2025-02-07 15:28:20,234] Trial 11 finished with value: 0.13140635715792592 and parameters: {'max_depth': 13, 'gamma': 15, 'max_delta_step': 20, 'min_child_weight': 18, 'learning_rate': 0.23404003767141715, 'subsample': 0.5378289209456484, 'n_estimators': 89}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:20,489] Trial 12 finished with value: 0.06620687340508336 and parameters: {'max_depth': 14, 'gamma': 14, 'max_delta_step': 20, 'min_child_weight': 20, 'learning_rate': 0.2166202046721727, 'subsample': 0.6851547293930649, 'n_estimators': 77}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:20,770] Trial 13 finished with value: 0.010874334852017165 and parameters: {'max_depth': 14, 'gamma': 15, 'max_delta_step': 20, 'min_child_weight': 17, 'learning_rate': 0.5733830271817772, 'subsample': 0.42870029005583954, 'n_estimators': 92}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:21,004] Trial 14 finished with value: 0.01127642830739961 and parameters: {'max_depth': 9, 'gamma': 10, 'max_delta_step': 18, 'min_child_weight': 17, 'learning_rate': 0.5912169907230393, 'subsample': 0.6980976810165741, 'n_estimators': 34}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:21,397] Trial 15 finished with value: 0.032521511571804496 and parameters: {'max_depth': 20, 'gamma': 15, 'max_delta_step': 18, 'min_child_weight': 17, 'learning_rate': 0.005134937064367545, 'subsample': 0.4140006855930202, 'n_estimators': 100}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:21,793] Trial 16 finished with value: 0.10565736156689942 and parameters: {'max_depth': 12, 'gamma': 10, 'max_delta_step': 17, 'min_child_weight': 15, 'learning_rate': 0.30043013005464, 'subsample': 0.794850718747977, 'n_estimators': 180}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:22,047] Trial 17 finished with value: 0.10184781963825273 and parameters: {'max_depth': 15, 'gamma': 17, 'max_delta_step': 13, 'min_child_weight': 20, 'learning_rate': 0.1542125358707155, 'subsample': 0.5321059767843839, 'n_estimators': 53}. Best is trial 11 with value: 0.13140635715792592.\n",
      "[I 2025-02-07 15:28:22,334] Trial 18 finished with value: 0.1341775028286305 and parameters: {'max_depth': 6, 'gamma': 13, 'max_delta_step': 9, 'min_child_weight': 8, 'learning_rate': 0.2742674445564709, 'subsample': 0.3893804255915998, 'n_estimators': 109}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:22,562] Trial 19 finished with value: -0.11236319753648694 and parameters: {'max_depth': 6, 'gamma': 8, 'max_delta_step': 9, 'min_child_weight': 8, 'learning_rate': 0.573571128275111, 'subsample': 0.37796680719585496, 'n_estimators': 109}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:22,852] Trial 20 finished with value: -0.00040170854446008875 and parameters: {'max_depth': 6, 'gamma': 12, 'max_delta_step': 8, 'min_child_weight': 7, 'learning_rate': 0.10222641727195561, 'subsample': 0.004859154795805787, 'n_estimators': 179}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:23,148] Trial 21 finished with value: 0.049125637014468704 and parameters: {'max_depth': 11, 'gamma': 13, 'max_delta_step': 10, 'min_child_weight': 9, 'learning_rate': 0.2741285884445652, 'subsample': 0.5834656582635457, 'n_estimators': 113}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:23,385] Trial 22 finished with value: 0.10088767130769238 and parameters: {'max_depth': 10, 'gamma': 17, 'max_delta_step': 4, 'min_child_weight': 5, 'learning_rate': 0.3501373107531228, 'subsample': 0.33325052583171977, 'n_estimators': 59}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:23,766] Trial 23 finished with value: 0.11308107266086631 and parameters: {'max_depth': 7, 'gamma': 17, 'max_delta_step': 18, 'min_child_weight': 12, 'learning_rate': 0.24083841438086362, 'subsample': 0.44873980326974855, 'n_estimators': 84}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:24,064] Trial 24 finished with value: 0.002061947434064626 and parameters: {'max_depth': 13, 'gamma': 11, 'max_delta_step': 20, 'min_child_weight': 18, 'learning_rate': 0.4899984208649612, 'subsample': 0.6552055481470146, 'n_estimators': 119}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:24,260] Trial 25 finished with value: 0.1326666503235786 and parameters: {'max_depth': 10, 'gamma': 8, 'max_delta_step': 15, 'min_child_weight': 15, 'learning_rate': 0.19522399276778457, 'subsample': 0.48871911661859047, 'n_estimators': 75}. Best is trial 18 with value: 0.1341775028286305.\n",
      "[I 2025-02-07 15:28:24,484] Trial 26 finished with value: 0.14301362685864816 and parameters: {'max_depth': 5, 'gamma': 9, 'max_delta_step': 14, 'min_child_weight': 15, 'learning_rate': 0.13903044657056976, 'subsample': 0.46147041767084673, 'n_estimators': 41}. Best is trial 26 with value: 0.14301362685864816.\n",
      "[I 2025-02-07 15:28:24,734] Trial 27 finished with value: 0.014066081367773764 and parameters: {'max_depth': 5, 'gamma': 8, 'max_delta_step': 12, 'min_child_weight': 15, 'learning_rate': 0.004385280843998363, 'subsample': 0.26144889935563764, 'n_estimators': 37}. Best is trial 26 with value: 0.14301362685864816.\n",
      "[I 2025-02-07 15:28:24,878] Trial 28 finished with value: 0.13698107088605438 and parameters: {'max_depth': 9, 'gamma': 8, 'max_delta_step': 14, 'min_child_weight': 13, 'learning_rate': 0.15390546445078357, 'subsample': 0.47274519221206146, 'n_estimators': 14}. Best is trial 26 with value: 0.14301362685864816.\n",
      "[I 2025-02-07 15:28:25,010] Trial 29 finished with value: 0.10273111037147653 and parameters: {'max_depth': 8, 'gamma': 9, 'max_delta_step': 14, 'min_child_weight': 13, 'learning_rate': 0.12784981321732589, 'subsample': 0.3581812115150807, 'n_estimators': 15}. Best is trial 26 with value: 0.14301362685864816.\n",
      "[I 2025-02-07 15:28:25,172] Trial 30 finished with value: 0.18207409449916212 and parameters: {'max_depth': 6, 'gamma': 2, 'max_delta_step': 10, 'min_child_weight': 12, 'learning_rate': 0.10325607682984506, 'subsample': 0.1969882252773792, 'n_estimators': 24}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:25,337] Trial 31 finished with value: 0.09429737541332273 and parameters: {'max_depth': 7, 'gamma': 2, 'max_delta_step': 10, 'min_child_weight': 11, 'learning_rate': 0.06649649183080387, 'subsample': 0.19185167337425715, 'n_estimators': 11}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:25,590] Trial 32 finished with value: 0.13342583386937712 and parameters: {'max_depth': 5, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 12, 'learning_rate': 0.16566137716972734, 'subsample': 0.22487285345682126, 'n_estimators': 35}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:25,949] Trial 33 finished with value: 0.15281022258533683 and parameters: {'max_depth': 3, 'gamma': 2, 'max_delta_step': 14, 'min_child_weight': 10, 'learning_rate': 0.06863422140655429, 'subsample': 0.3220077806305631, 'n_estimators': 49}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:26,228] Trial 34 finished with value: 0.15608965705437783 and parameters: {'max_depth': 3, 'gamma': 2, 'max_delta_step': 14, 'min_child_weight': 10, 'learning_rate': 0.08044604168892622, 'subsample': 0.3220880477682864, 'n_estimators': 45}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:26,543] Trial 35 finished with value: 0.15599047120631093 and parameters: {'max_depth': 3, 'gamma': 1, 'max_delta_step': 12, 'min_child_weight': 10, 'learning_rate': 0.06152062677363261, 'subsample': 0.3080615601799128, 'n_estimators': 50}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:26,855] Trial 36 finished with value: 0.16156583081557663 and parameters: {'max_depth': 3, 'gamma': 2, 'max_delta_step': 11, 'min_child_weight': 10, 'learning_rate': 0.07230307704329952, 'subsample': 0.13280694604482626, 'n_estimators': 66}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:27,046] Trial 37 finished with value: 0.13833483985132833 and parameters: {'max_depth': 1, 'gamma': 2, 'max_delta_step': 12, 'min_child_weight': 9, 'learning_rate': 0.031301573844430566, 'subsample': 0.0852238135506998, 'n_estimators': 65}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:27,229] Trial 38 finished with value: 0.10392336896231202 and parameters: {'max_depth': 3, 'gamma': 0, 'max_delta_step': 11, 'min_child_weight': 11, 'learning_rate': 0.09254738787771223, 'subsample': 0.14699079439652696, 'n_estimators': 28}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:27,433] Trial 39 finished with value: -0.00010811964013490716 and parameters: {'max_depth': 2, 'gamma': 3, 'max_delta_step': 6, 'min_child_weight': 6, 'learning_rate': 0.04234024263010971, 'subsample': 0.004869256860177806, 'n_estimators': 65}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:27,609] Trial 40 finished with value: -0.19537884029657326 and parameters: {'max_depth': 4, 'gamma': 6, 'max_delta_step': 11, 'min_child_weight': 9, 'learning_rate': 0.7013619317859779, 'subsample': 0.2260445948437562, 'n_estimators': 50}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:27,833] Trial 41 finished with value: 0.16261780395744752 and parameters: {'max_depth': 3, 'gamma': 1, 'max_delta_step': 13, 'min_child_weight': 10, 'learning_rate': 0.0894435373972336, 'subsample': 0.3163842988398426, 'n_estimators': 46}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,055] Trial 42 finished with value: 0.15083669418676793 and parameters: {'max_depth': 2, 'gamma': 1, 'max_delta_step': 13, 'min_child_weight': 11, 'learning_rate': 0.08120805748788334, 'subsample': 0.2888958831134645, 'n_estimators': 25}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,252] Trial 43 finished with value: 0.16983937373379765 and parameters: {'max_depth': 1, 'gamma': 4, 'max_delta_step': 12, 'min_child_weight': 10, 'learning_rate': 0.11389684805831454, 'subsample': 0.11790105460519806, 'n_estimators': 69}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,446] Trial 44 finished with value: -0.5584346497191439 and parameters: {'max_depth': 1, 'gamma': 4, 'max_delta_step': 16, 'min_child_weight': 13, 'learning_rate': 0.998642291626727, 'subsample': 0.09388769280828618, 'n_estimators': 74}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,643] Trial 45 finished with value: 0.1089891097763932 and parameters: {'max_depth': 2, 'gamma': 4, 'max_delta_step': 13, 'min_child_weight': 8, 'learning_rate': 0.1144062173398826, 'subsample': 0.17478574157929683, 'n_estimators': 44}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,788] Trial 46 finished with value: -0.012727486023741186 and parameters: {'max_depth': 4, 'gamma': 3, 'max_delta_step': 9, 'min_child_weight': 1, 'learning_rate': 0.18332001089932076, 'subsample': 0.12546090782600308, 'n_estimators': 22}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:28,959] Trial 47 finished with value: -0.031225335756644323 and parameters: {'max_depth': 4, 'gamma': 5, 'max_delta_step': 15, 'min_child_weight': 12, 'learning_rate': 0.3740127158064802, 'subsample': 0.04917525837938817, 'n_estimators': 64}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:29,226] Trial 48 finished with value: 0.11464617809845323 and parameters: {'max_depth': 1, 'gamma': 1, 'max_delta_step': 11, 'min_child_weight': 10, 'learning_rate': 0.21965119136671626, 'subsample': 0.2182359144736249, 'n_estimators': 79}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:29,547] Trial 49 finished with value: 0.12676280918563743 and parameters: {'max_depth': 2, 'gamma': 5, 'max_delta_step': 16, 'min_child_weight': 7, 'learning_rate': 0.013177326344623874, 'subsample': 0.25798698894106475, 'n_estimators': 135}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:29,694] Trial 50 finished with value: 0.16104365108370378 and parameters: {'max_depth': 3, 'gamma': 6, 'max_delta_step': 7, 'min_child_weight': 9, 'learning_rate': 0.43994722381659646, 'subsample': 0.15967667819270442, 'n_estimators': 28}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:29,843] Trial 51 finished with value: -0.7393804291732267 and parameters: {'max_depth': 3, 'gamma': 6, 'max_delta_step': 7, 'min_child_weight': 9, 'learning_rate': 0.8303176456142821, 'subsample': 0.17186576318722935, 'n_estimators': 27}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:30,131] Trial 52 finished with value: -0.35125612697665254 and parameters: {'max_depth': 4, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 10, 'learning_rate': 0.428758894154517, 'subsample': 0.14721546712310402, 'n_estimators': 152}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:30,299] Trial 53 finished with value: -0.15697371139063043 and parameters: {'max_depth': 1, 'gamma': 4, 'max_delta_step': 10, 'min_child_weight': 12, 'learning_rate': 0.6854495343940635, 'subsample': 0.0394503072089159, 'n_estimators': 60}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:30,482] Trial 54 finished with value: 0.13521711672282222 and parameters: {'max_depth': 3, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 8, 'learning_rate': 0.11759269767447805, 'subsample': 0.09878102642821868, 'n_estimators': 40}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:30,654] Trial 55 finished with value: 0.13825792869787779 and parameters: {'max_depth': 5, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 11, 'learning_rate': 0.32607384741041534, 'subsample': 0.9377244346886708, 'n_estimators': 20}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:30,822] Trial 56 finished with value: 0.15191159877087934 and parameters: {'max_depth': 2, 'gamma': 1, 'max_delta_step': 2, 'min_child_weight': 9, 'learning_rate': 0.19105869476766008, 'subsample': 0.2545963465789691, 'n_estimators': 30}. Best is trial 30 with value: 0.18207409449916212.\n",
      "[I 2025-02-07 15:28:31,035] Trial 57 finished with value: 0.19958827883911623 and parameters: {'max_depth': 7, 'gamma': 3, 'max_delta_step': 12, 'min_child_weight': 14, 'learning_rate': 0.24657925961416427, 'subsample': 0.1188226965645793, 'n_estimators': 55}. Best is trial 57 with value: 0.19958827883911623.\n",
      "[I 2025-02-07 15:28:31,246] Trial 58 finished with value: -0.05890194225227963 and parameters: {'max_depth': 7, 'gamma': 7, 'max_delta_step': 10, 'min_child_weight': 14, 'learning_rate': 0.5218747969326288, 'subsample': 0.12725194768455858, 'n_estimators': 97}. Best is trial 57 with value: 0.19958827883911623.\n",
      "[I 2025-02-07 15:28:31,430] Trial 59 finished with value: -0.027596575343410867 and parameters: {'max_depth': 6, 'gamma': 5, 'max_delta_step': 12, 'min_child_weight': 13, 'learning_rate': 0.26328949505978805, 'subsample': 0.0573669619474268, 'n_estimators': 57}. Best is trial 57 with value: 0.19958827883911623.\n",
      "[I 2025-02-07 15:28:31,631] Trial 60 finished with value: 0.03215876048434907 and parameters: {'max_depth': 8, 'gamma': 3, 'max_delta_step': 13, 'min_child_weight': 16, 'learning_rate': 0.41689425737968633, 'subsample': 0.1958763191177055, 'n_estimators': 69}. Best is trial 57 with value: 0.19958827883911623.\n",
      "[I 2025-02-07 15:28:31,809] Trial 61 finished with value: 0.12774536122163516 and parameters: {'max_depth': 3, 'gamma': 4, 'max_delta_step': 11, 'min_child_weight': 7, 'learning_rate': 0.0372113852471988, 'subsample': 0.11430161733303237, 'n_estimators': 47}. Best is trial 57 with value: 0.19958827883911623.\n",
      "[I 2025-02-07 15:28:32,043] Trial 62 finished with value: 0.21516605904177843 and parameters: {'max_depth': 4, 'gamma': 2, 'max_delta_step': 15, 'min_child_weight': 14, 'learning_rate': 0.10783473678493416, 'subsample': 0.15675772385258432, 'n_estimators': 88}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:32,262] Trial 63 finished with value: 0.18593660318089156 and parameters: {'max_depth': 5, 'gamma': 3, 'max_delta_step': 15, 'min_child_weight': 14, 'learning_rate': 0.14664434984421715, 'subsample': 0.1572424584324067, 'n_estimators': 86}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:32,500] Trial 64 finished with value: 0.14506454285149584 and parameters: {'max_depth': 6, 'gamma': 3, 'max_delta_step': 16, 'min_child_weight': 14, 'learning_rate': 0.14741579884742112, 'subsample': 0.23569514470957292, 'n_estimators': 86}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:32,720] Trial 65 finished with value: -0.008607393617910963 and parameters: {'max_depth': 5, 'gamma': 1, 'max_delta_step': 15, 'min_child_weight': 16, 'learning_rate': 0.20510936224046075, 'subsample': 0.02853505216918878, 'n_estimators': 92}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:33,038] Trial 66 finished with value: 0.1848909259434358 and parameters: {'max_depth': 4, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 14, 'learning_rate': 0.10819319518441924, 'subsample': 0.08176766845916428, 'n_estimators': 102}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:33,358] Trial 67 finished with value: 0.20567589080246695 and parameters: {'max_depth': 7, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 16, 'learning_rate': 0.24063271166249556, 'subsample': 0.08630684145080271, 'n_estimators': 116}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:33,802] Trial 68 finished with value: 0.17553190969925359 and parameters: {'max_depth': 7, 'gamma': 0, 'max_delta_step': 19, 'min_child_weight': 16, 'learning_rate': 0.23353085865797274, 'subsample': 0.08551914364215306, 'n_estimators': 106}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:34,159] Trial 69 finished with value: 0.11375408061308745 and parameters: {'max_depth': 8, 'gamma': 0, 'max_delta_step': 19, 'min_child_weight': 16, 'learning_rate': 0.3016664600445827, 'subsample': 0.07514145159573647, 'n_estimators': 122}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:34,457] Trial 70 finished with value: 0.06859219392148674 and parameters: {'max_depth': 7, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 17, 'learning_rate': 0.23878813790575432, 'subsample': 0.07082531472380248, 'n_estimators': 104}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:34,990] Trial 71 finished with value: 0.18295654051549015 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.15953900326647916, 'subsample': 0.10420362237672806, 'n_estimators': 118}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:35,243] Trial 72 finished with value: -0.0015779082761011587 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.16940706732273875, 'subsample': 0.020721078265386675, 'n_estimators': 126}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:35,679] Trial 73 finished with value: -0.06423881330896064 and parameters: {'max_depth': 9, 'gamma': 1, 'max_delta_step': 17, 'min_child_weight': 15, 'learning_rate': 0.25459628076351554, 'subsample': 0.1879787439616711, 'n_estimators': 113}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:35,968] Trial 74 finished with value: 0.011269933971088997 and parameters: {'max_depth': 7, 'gamma': 2, 'max_delta_step': 19, 'min_child_weight': 16, 'learning_rate': 0.3382429097754942, 'subsample': 0.09215600840998205, 'n_estimators': 140}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:36,231] Trial 75 finished with value: 0.07348372436004802 and parameters: {'max_depth': 6, 'gamma': 0, 'max_delta_step': 18, 'min_child_weight': 15, 'learning_rate': 0.2898209909782454, 'subsample': 0.043544781752104814, 'n_estimators': 105}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:36,715] Trial 76 finished with value: 0.19561750324006777 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 18, 'min_child_weight': 19, 'learning_rate': 0.1398234774015445, 'subsample': 0.16343441581853604, 'n_estimators': 117}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:37,113] Trial 77 finished with value: 0.17125919488844665 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 18, 'min_child_weight': 19, 'learning_rate': 0.14246845344781853, 'subsample': 0.157341893224239, 'n_estimators': 117}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:37,423] Trial 78 finished with value: 0.14612025018914443 and parameters: {'max_depth': 11, 'gamma': 2, 'max_delta_step': 17, 'min_child_weight': 19, 'learning_rate': 0.17761676852819866, 'subsample': 0.20282725258462525, 'n_estimators': 97}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:37,692] Trial 79 finished with value: -6.809261648044185e-05 and parameters: {'max_depth': 8, 'gamma': 3, 'max_delta_step': 17, 'min_child_weight': 13, 'learning_rate': 0.2057129223823003, 'subsample': 0.0036012761914209213, 'n_estimators': 150}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:38,022] Trial 80 finished with value: 0.17891639013128713 and parameters: {'max_depth': 12, 'gamma': 1, 'max_delta_step': 16, 'min_child_weight': 18, 'learning_rate': 0.12795352522761344, 'subsample': 0.14798913411750303, 'n_estimators': 130}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:38,583] Trial 81 finished with value: 0.1288146164837628 and parameters: {'max_depth': 12, 'gamma': 1, 'max_delta_step': 16, 'min_child_weight': 18, 'learning_rate': 0.13704289888900872, 'subsample': 0.14701101577482995, 'n_estimators': 129}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:38,920] Trial 82 finished with value: 0.16938770913623913 and parameters: {'max_depth': 11, 'gamma': 2, 'max_delta_step': 15, 'min_child_weight': 14, 'learning_rate': 0.09776201497516465, 'subsample': 0.10892166702758896, 'n_estimators': 137}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:39,299] Trial 83 finished with value: 0.17431429472448812 and parameters: {'max_depth': 13, 'gamma': 1, 'max_delta_step': 18, 'min_child_weight': 20, 'learning_rate': 0.16330154697449054, 'subsample': 0.16937161801363745, 'n_estimators': 144}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:39,718] Trial 84 finished with value: 0.18077728489007205 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 18, 'learning_rate': 0.11870186026195542, 'subsample': 0.28348432202910023, 'n_estimators': 114}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:40,083] Trial 85 finished with value: 0.1889960052934886 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 20, 'min_child_weight': 17, 'learning_rate': 0.039748820864694945, 'subsample': 0.21214756169811, 'n_estimators': 112}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:40,339] Trial 86 finished with value: 0.18126928620098015 and parameters: {'max_depth': 10, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.05351999301233723, 'subsample': 0.2107354545170384, 'n_estimators': 90}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:40,691] Trial 87 finished with value: 0.030751696194322053 and parameters: {'max_depth': 20, 'gamma': 3, 'max_delta_step': 19, 'min_child_weight': 17, 'learning_rate': 0.002976215226449183, 'subsample': 0.06385698014803795, 'n_estimators': 163}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:41,017] Trial 88 finished with value: 0.16520893836151018 and parameters: {'max_depth': 5, 'gamma': 0, 'max_delta_step': 20, 'min_child_weight': 17, 'learning_rate': 0.02395188493363981, 'subsample': 0.25281463908728813, 'n_estimators': 81}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:41,340] Trial 89 finished with value: 0.15803506457861227 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 18, 'min_child_weight': 13, 'learning_rate': 0.05159893988289833, 'subsample': 0.18007993000725264, 'n_estimators': 122}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:41,755] Trial 90 finished with value: 0.16060736257216335 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 18, 'min_child_weight': 12, 'learning_rate': 0.08936213323716256, 'subsample': 0.13179323860510117, 'n_estimators': 100}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:42,024] Trial 91 finished with value: 0.158938069566946 and parameters: {'max_depth': 6, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.05424988338069649, 'subsample': 0.22721037956909876, 'n_estimators': 94}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:42,446] Trial 92 finished with value: -0.07052359293742327 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 19, 'min_child_weight': 2, 'learning_rate': 0.07119119020596235, 'subsample': 0.20336023877307324, 'n_estimators': 110}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:42,729] Trial 93 finished with value: 0.212655626723121 and parameters: {'max_depth': 10, 'gamma': 3, 'max_delta_step': 20, 'min_child_weight': 14, 'learning_rate': 0.09889612004668219, 'subsample': 0.10320893760762506, 'n_estimators': 87}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:43,016] Trial 94 finished with value: 0.16972122558920244 and parameters: {'max_depth': 11, 'gamma': 3, 'max_delta_step': 17, 'min_child_weight': 14, 'learning_rate': 0.22102468987495577, 'subsample': 0.10654992060232958, 'n_estimators': 85}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:43,268] Trial 95 finished with value: 0.15863840984431643 and parameters: {'max_depth': 5, 'gamma': 4, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.10547791811444533, 'subsample': 0.13284910801066574, 'n_estimators': 120}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:43,531] Trial 96 finished with value: -2.4389394290391664e-05 and parameters: {'max_depth': 4, 'gamma': 20, 'max_delta_step': 18, 'min_child_weight': 14, 'learning_rate': 0.1543806623221701, 'subsample': 0.059013015254752575, 'n_estimators': 104}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:43,796] Trial 97 finished with value: 0.14417383469969458 and parameters: {'max_depth': 8, 'gamma': 1, 'max_delta_step': 20, 'min_child_weight': 13, 'learning_rate': 0.18317282957325853, 'subsample': 0.08311880168118652, 'n_estimators': 76}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:44,135] Trial 98 finished with value: 0.01668824418620829 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 15, 'learning_rate': 0.1369425619347908, 'subsample': 0.02570462564112351, 'n_estimators': 225}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:44,407] Trial 99 finished with value: 0.11349236322761824 and parameters: {'max_depth': 6, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 13, 'learning_rate': 0.19721398794353878, 'subsample': 0.17318160927799545, 'n_estimators': 101}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:44,644] Trial 100 finished with value: -0.0005287482158462531 and parameters: {'max_depth': 7, 'gamma': 19, 'max_delta_step': 19, 'min_child_weight': 16, 'learning_rate': 0.02535897874032447, 'subsample': 0.10692660935454902, 'n_estimators': 115}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:44,922] Trial 101 finished with value: 0.1477206947961709 and parameters: {'max_depth': 10, 'gamma': 3, 'max_delta_step': 20, 'min_child_weight': 19, 'learning_rate': 0.04991948121974801, 'subsample': 0.7660270964043308, 'n_estimators': 91}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:45,186] Trial 102 finished with value: 0.1416543704188371 and parameters: {'max_depth': 11, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.1005259990674781, 'subsample': 0.21331750065206823, 'n_estimators': 88}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:45,458] Trial 103 finished with value: 0.17876638159715874 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 9, 'min_child_weight': 14, 'learning_rate': 0.11302047307606503, 'subsample': 0.13619110483693514, 'n_estimators': 80}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:45,744] Trial 104 finished with value: 0.15694518664555546 and parameters: {'max_depth': 4, 'gamma': 3, 'max_delta_step': 14, 'min_child_weight': 15, 'learning_rate': 0.07733853604486221, 'subsample': 0.18762546583889342, 'n_estimators': 111}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:46,027] Trial 105 finished with value: 0.14385515796515258 and parameters: {'max_depth': 14, 'gamma': 5, 'max_delta_step': 19, 'min_child_weight': 12, 'learning_rate': 0.16420903567214865, 'subsample': 0.36581392804304436, 'n_estimators': 72}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:46,317] Trial 106 finished with value: 0.07913423720228485 and parameters: {'max_depth': 12, 'gamma': 11, 'max_delta_step': 18, 'min_child_weight': 16, 'learning_rate': 0.03935926480996138, 'subsample': 0.27651117126831043, 'n_estimators': 55}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:46,566] Trial 107 finished with value: 0.17351359127388755 and parameters: {'max_depth': 8, 'gamma': 4, 'max_delta_step': 20, 'min_child_weight': 17, 'learning_rate': 0.06822491967954644, 'subsample': 0.23818340507104907, 'n_estimators': 95}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:46,902] Trial 108 finished with value: -1.640145353342449 and parameters: {'max_depth': 5, 'gamma': 2, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.9048158317783018, 'subsample': 0.30000774197171065, 'n_estimators': 88}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:47,269] Trial 109 finished with value: 0.06876690946807351 and parameters: {'max_depth': 19, 'gamma': 0, 'max_delta_step': 16, 'min_child_weight': 13, 'learning_rate': 0.13678574307351193, 'subsample': 0.1162772937348151, 'n_estimators': 107}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:47,510] Trial 110 finished with value: 0.04430248026843275 and parameters: {'max_depth': 9, 'gamma': 16, 'max_delta_step': 17, 'min_child_weight': 15, 'learning_rate': 0.08976064319668231, 'subsample': 0.16969008819319886, 'n_estimators': 123}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:48,013] Trial 111 finished with value: 0.111518363403186 and parameters: {'max_depth': 17, 'gamma': 0, 'max_delta_step': 16, 'min_child_weight': 18, 'learning_rate': 0.12112468781310344, 'subsample': 0.5572603433812809, 'n_estimators': 116}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:48,382] Trial 112 finished with value: 0.1425728336606945 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 15, 'min_child_weight': 19, 'learning_rate': 0.10761151564109464, 'subsample': 0.24781945774628994, 'n_estimators': 126}. Best is trial 62 with value: 0.21516605904177843.\n",
      "[I 2025-02-07 15:28:48,729] Trial 113 finished with value: 0.2289092424234367 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 18, 'learning_rate': 0.16199012886165273, 'subsample': 0.1523002281837741, 'n_estimators': 100}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:49,034] Trial 114 finished with value: 0.0703232301963802 and parameters: {'max_depth': 17, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 16, 'learning_rate': 0.24929120440681118, 'subsample': 0.15125411176979703, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:49,318] Trial 115 finished with value: 0.1949431569318395 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 13, 'min_child_weight': 17, 'learning_rate': 0.17631758087153004, 'subsample': 0.08167942962079847, 'n_estimators': 101}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:49,602] Trial 116 finished with value: 0.16777144755323414 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 17, 'learning_rate': 0.21655961252397501, 'subsample': 0.07745829566117232, 'n_estimators': 101}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:49,913] Trial 117 finished with value: -0.002605558537168262 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 13, 'min_child_weight': 20, 'learning_rate': 0.18058152473790895, 'subsample': 0.04188844486575716, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:50,309] Trial 118 finished with value: 0.02170881076881659 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 13, 'min_child_weight': 17, 'learning_rate': 0.27379498707132144, 'subsample': 0.10296213936120835, 'n_estimators': 131}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:50,624] Trial 119 finished with value: 0.07081635585019885 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 10, 'min_child_weight': 18, 'learning_rate': 0.1581910753540753, 'subsample': 0.06169450784779834, 'n_estimators': 119}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:50,997] Trial 120 finished with value: 0.13612636295690395 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 12, 'min_child_weight': 12, 'learning_rate': 0.1966956351316805, 'subsample': 0.09073335978212474, 'n_estimators': 110}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:51,269] Trial 121 finished with value: 0.18493535975534625 and parameters: {'max_depth': 9, 'gamma': 2, 'max_delta_step': 18, 'min_child_weight': 14, 'learning_rate': 0.14952162424044776, 'subsample': 0.19633515159632653, 'n_estimators': 89}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:51,530] Trial 122 finished with value: 0.15247893182714456 and parameters: {'max_depth': 5, 'gamma': 2, 'max_delta_step': 16, 'min_child_weight': 14, 'learning_rate': 0.15000592720707012, 'subsample': 0.12643158161375348, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:51,867] Trial 123 finished with value: 0.19134740719955579 and parameters: {'max_depth': 6, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 19, 'learning_rate': 0.1692223211388909, 'subsample': 0.1572024039484118, 'n_estimators': 106}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:52,204] Trial 124 finished with value: 0.09679869051676782 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 19, 'learning_rate': 0.2295480175129892, 'subsample': 0.15842275345344176, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:52,567] Trial 125 finished with value: 0.15106611277431736 and parameters: {'max_depth': 7, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 19, 'learning_rate': 0.17597444010322943, 'subsample': 0.1373650421212533, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:53,015] Trial 126 finished with value: 0.16900896658271602 and parameters: {'max_depth': 8, 'gamma': 0, 'max_delta_step': 13, 'min_child_weight': 18, 'learning_rate': 0.13148481963498773, 'subsample': 0.18651168531356568, 'n_estimators': 109}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:53,282] Trial 127 finished with value: 0.19991786248220633 and parameters: {'max_depth': 9, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 20, 'learning_rate': 0.20434550045661193, 'subsample': 0.09976877905027788, 'n_estimators': 78}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:53,542] Trial 128 finished with value: -0.02321869373343821 and parameters: {'max_depth': 4, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 20, 'learning_rate': 0.21816864997117866, 'subsample': 0.021866841068425083, 'n_estimators': 71}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:53,846] Trial 129 finished with value: 0.04463610968833853 and parameters: {'max_depth': 13, 'gamma': 3, 'max_delta_step': 14, 'min_child_weight': 20, 'learning_rate': 0.28410321347832956, 'subsample': 0.07372203413951922, 'n_estimators': 80}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:54,266] Trial 130 finished with value: 0.1713723197507918 and parameters: {'max_depth': 6, 'gamma': 2, 'max_delta_step': 15, 'min_child_weight': 19, 'learning_rate': 0.2414718385064895, 'subsample': 0.1599539276476411, 'n_estimators': 87}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:54,538] Trial 131 finished with value: 0.17740314283184344 and parameters: {'max_depth': 9, 'gamma': 1, 'max_delta_step': 18, 'min_child_weight': 20, 'learning_rate': 0.1955947510713506, 'subsample': 0.11684838302679015, 'n_estimators': 76}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:54,858] Trial 132 finished with value: 0.1540456511046684 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 18, 'learning_rate': 0.16313551331325962, 'subsample': 0.10060477007522363, 'n_estimators': 107}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:55,083] Trial 133 finished with value: 0.13183665453288307 and parameters: {'max_depth': 10, 'gamma': 0, 'max_delta_step': 13, 'min_child_weight': 18, 'learning_rate': 0.6188199264599084, 'subsample': 0.04270332627137222, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:55,369] Trial 134 finished with value: 0.17694129855231966 and parameters: {'max_depth': 11, 'gamma': 1, 'max_delta_step': 15, 'min_child_weight': 19, 'learning_rate': 0.17901835382334763, 'subsample': 0.08969376377632766, 'n_estimators': 91}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:55,778] Trial 135 finished with value: 0.09880202984018449 and parameters: {'max_depth': 9, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 17, 'learning_rate': 0.3131302587785946, 'subsample': 0.1376936496611743, 'n_estimators': 84}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:56,058] Trial 136 finished with value: 0.0853045304029727 and parameters: {'max_depth': 14, 'gamma': 2, 'max_delta_step': 16, 'min_child_weight': 16, 'learning_rate': 0.1377669491790078, 'subsample': 0.061445187434273615, 'n_estimators': 117}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:56,328] Trial 137 finished with value: -0.09390159720054636 and parameters: {'max_depth': 7, 'gamma': 0, 'max_delta_step': 12, 'min_child_weight': 13, 'learning_rate': 0.3600693293233209, 'subsample': 0.4048529916766144, 'n_estimators': 62}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:56,611] Trial 138 finished with value: -0.02465365908795869 and parameters: {'max_depth': 8, 'gamma': 2, 'max_delta_step': 17, 'min_child_weight': 14, 'learning_rate': 0.4883265756622723, 'subsample': 0.6311839578448794, 'n_estimators': 125}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:56,990] Trial 139 finished with value: 0.07051273198714347 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 18, 'min_child_weight': 15, 'learning_rate': 0.26186929339661363, 'subsample': 0.11503641486117337, 'n_estimators': 102}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:57,258] Trial 140 finished with value: 0.13339786420867772 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 13, 'min_child_weight': 19, 'learning_rate': 0.2009675599823592, 'subsample': 0.19544696243324072, 'n_estimators': 112}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:57,564] Trial 141 finished with value: 0.16129807060378665 and parameters: {'max_depth': 6, 'gamma': 2, 'max_delta_step': 11, 'min_child_weight': 13, 'learning_rate': 0.11317690390280238, 'subsample': 0.1576899510725897, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:57,853] Trial 142 finished with value: 0.17256257950351983 and parameters: {'max_depth': 4, 'gamma': 0, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.08584327306112367, 'subsample': 0.21891549470067376, 'n_estimators': 97}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:58,108] Trial 143 finished with value: 0.17890415651453395 and parameters: {'max_depth': 5, 'gamma': 4, 'max_delta_step': 14, 'min_child_weight': 14, 'learning_rate': 0.15118680202196866, 'subsample': 0.14550665678151242, 'n_estimators': 105}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:58,353] Trial 144 finished with value: 0.15151013897040788 and parameters: {'max_depth': 7, 'gamma': 3, 'max_delta_step': 15, 'min_child_weight': 15, 'learning_rate': 0.12307398287224874, 'subsample': 0.17574171860096038, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:58,858] Trial 145 finished with value: 0.1444427503517799 and parameters: {'max_depth': 6, 'gamma': 1, 'max_delta_step': 0, 'min_child_weight': 17, 'learning_rate': 0.09325371122218584, 'subsample': 0.20129038869114455, 'n_estimators': 113}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:59,176] Trial 146 finished with value: 0.04174649263854058 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 16, 'min_child_weight': 13, 'learning_rate': 0.17003382187291305, 'subsample': 0.12731149822086868, 'n_estimators': 78}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:59,423] Trial 147 finished with value: 0.15247210779672915 and parameters: {'max_depth': 5, 'gamma': 2, 'max_delta_step': 11, 'min_child_weight': 11, 'learning_rate': 0.15157375348920035, 'subsample': 0.08736882217445627, 'n_estimators': 68}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:28:59,867] Trial 148 finished with value: 0.15179490283858144 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 14, 'min_child_weight': 20, 'learning_rate': 0.21070537368849138, 'subsample': 0.1761805380155491, 'n_estimators': 90}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:00,101] Trial 149 finished with value: 0.15723320275091135 and parameters: {'max_depth': 8, 'gamma': 0, 'max_delta_step': 12, 'min_child_weight': 16, 'learning_rate': 0.07776505079993502, 'subsample': 0.10400648675096977, 'n_estimators': 35}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:00,375] Trial 150 finished with value: 0.20187260930734763 and parameters: {'max_depth': 10, 'gamma': 2, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.12945238671690676, 'subsample': 0.15407954105924915, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:00,542] Trial 151 finished with value: 0.13189928268745987 and parameters: {'max_depth': 10, 'gamma': 3, 'max_delta_step': 19, 'min_child_weight': 14, 'learning_rate': 0.12055959371285493, 'subsample': 0.14392573070781595, 'n_estimators': 19}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:00,812] Trial 152 finished with value: 0.15238106054369938 and parameters: {'max_depth': 10, 'gamma': 2, 'max_delta_step': 18, 'min_child_weight': 14, 'learning_rate': 0.1904642271011395, 'subsample': 0.16550554495128256, 'n_estimators': 107}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:01,107] Trial 153 finished with value: 0.1715473729071093 and parameters: {'max_depth': 11, 'gamma': 2, 'max_delta_step': 19, 'min_child_weight': 13, 'learning_rate': 0.1360527089673868, 'subsample': 0.12261722320235952, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:01,531] Trial 154 finished with value: 0.12968577159892247 and parameters: {'max_depth': 7, 'gamma': 1, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.10497361872479426, 'subsample': 0.2277271436944907, 'n_estimators': 119}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:01,774] Trial 155 finished with value: 0.1556689538254572 and parameters: {'max_depth': 4, 'gamma': 4, 'max_delta_step': 18, 'min_child_weight': 18, 'learning_rate': 0.16192084454895778, 'subsample': 0.9170348960049557, 'n_estimators': 86}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:02,066] Trial 156 finished with value: 0.16480261131287965 and parameters: {'max_depth': 6, 'gamma': 3, 'max_delta_step': 9, 'min_child_weight': 12, 'learning_rate': 0.06651607046833038, 'subsample': 0.1924282762060588, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:02,376] Trial 157 finished with value: 0.13535604219915554 and parameters: {'max_depth': 9, 'gamma': 0, 'max_delta_step': 17, 'min_child_weight': 14, 'learning_rate': 0.17701041552030103, 'subsample': 0.07341819042612935, 'n_estimators': 95}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:02,739] Trial 158 finished with value: 0.1704847052260705 and parameters: {'max_depth': 8, 'gamma': 1, 'max_delta_step': 19, 'min_child_weight': 16, 'learning_rate': 0.022979511961203652, 'subsample': 0.10520122397400854, 'n_estimators': 114}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:03,054] Trial 159 finished with value: 0.08108352326079094 and parameters: {'max_depth': 11, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 13, 'learning_rate': 0.13868285236574382, 'subsample': 0.05571387411423852, 'n_estimators': 133}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:03,380] Trial 160 finished with value: -0.2174863973994332 and parameters: {'max_depth': 5, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 4, 'learning_rate': 0.22449601833621363, 'subsample': 0.15319657343123785, 'n_estimators': 109}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:03,551] Trial 161 finished with value: 0.04007608726531553 and parameters: {'max_depth': 10, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.06005834376188758, 'subsample': 0.22101602705518428, 'n_estimators': 10}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:03,854] Trial 162 finished with value: 0.16841643247761873 and parameters: {'max_depth': 10, 'gamma': 1, 'max_delta_step': 20, 'min_child_weight': 15, 'learning_rate': 0.042285146485958804, 'subsample': 0.19875287086504279, 'n_estimators': 89}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:04,114] Trial 163 finished with value: 0.16020931456785925 and parameters: {'max_depth': 9, 'gamma': 9, 'max_delta_step': 19, 'min_child_weight': 15, 'learning_rate': 0.09236372056175256, 'subsample': 0.26534393105130566, 'n_estimators': 90}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:04,472] Trial 164 finished with value: 0.17228850885314706 and parameters: {'max_depth': 10, 'gamma': 3, 'max_delta_step': 20, 'min_child_weight': 14, 'learning_rate': 0.10719958501960981, 'subsample': 0.207314821852033, 'n_estimators': 76}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:04,770] Trial 165 finished with value: 0.06558064950164744 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 13, 'min_child_weight': 16, 'learning_rate': 0.004367588777526195, 'subsample': 0.1296448682772666, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:05,096] Trial 166 finished with value: 0.1657044334595329 and parameters: {'max_depth': 11, 'gamma': 1, 'max_delta_step': 19, 'min_child_weight': 17, 'learning_rate': 0.047478369189175335, 'subsample': 0.17954351304761532, 'n_estimators': 94}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:05,416] Trial 167 finished with value: 0.15296951014155236 and parameters: {'max_depth': 6, 'gamma': 0, 'max_delta_step': 18, 'min_child_weight': 14, 'learning_rate': 0.12328030989679126, 'subsample': 0.2403768826816174, 'n_estimators': 84}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:05,767] Trial 168 finished with value: 0.13199239090855786 and parameters: {'max_depth': 9, 'gamma': 1, 'max_delta_step': 17, 'min_child_weight': 15, 'learning_rate': 0.15310187060812736, 'subsample': 0.34138588520071633, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:06,086] Trial 169 finished with value: 0.10752497128368776 and parameters: {'max_depth': 18, 'gamma': 13, 'max_delta_step': 18, 'min_child_weight': 19, 'learning_rate': 0.08270365003868539, 'subsample': 0.1641446147538583, 'n_estimators': 202}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:06,382] Trial 170 finished with value: 0.10500704333846067 and parameters: {'max_depth': 10, 'gamma': 2, 'max_delta_step': 20, 'min_child_weight': 14, 'learning_rate': 0.17915734623784646, 'subsample': 0.08688175945296824, 'n_estimators': 122}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:06,779] Trial 171 finished with value: 0.1912460546409751 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 14, 'min_child_weight': 18, 'learning_rate': 0.12591745880119193, 'subsample': 0.2836269351417056, 'n_estimators': 115}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:07,174] Trial 172 finished with value: 0.1784791978453606 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 14, 'min_child_weight': 18, 'learning_rate': 0.13118742978383952, 'subsample': 0.11949379739926266, 'n_estimators': 112}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:07,539] Trial 173 finished with value: 0.2044687031406922 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 10, 'min_child_weight': 17, 'learning_rate': 0.10295451677298097, 'subsample': 0.14811193617343427, 'n_estimators': 117}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:07,923] Trial 174 finished with value: 0.10085560607503308 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 14, 'min_child_weight': 17, 'learning_rate': 0.14914414220317151, 'subsample': 0.1445106491097311, 'n_estimators': 119}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:08,494] Trial 175 finished with value: 0.1688142542255202 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 15, 'min_child_weight': 17, 'learning_rate': 0.10346087921608915, 'subsample': 0.10236375003541004, 'n_estimators': 117}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:08,863] Trial 176 finished with value: 0.14199546691937392 and parameters: {'max_depth': 17, 'gamma': 1, 'max_delta_step': 11, 'min_child_weight': 19, 'learning_rate': 0.19822911837292187, 'subsample': 0.13432803029807128, 'n_estimators': 127}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:09,276] Trial 177 finished with value: 0.19296542725985044 and parameters: {'max_depth': 14, 'gamma': 0, 'max_delta_step': 10, 'min_child_weight': 18, 'learning_rate': 0.11632323237311316, 'subsample': 0.15981465420827173, 'n_estimators': 106}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:09,659] Trial 178 finished with value: 0.1490839464688456 and parameters: {'max_depth': 14, 'gamma': 0, 'max_delta_step': 10, 'min_child_weight': 18, 'learning_rate': 0.16781734827970993, 'subsample': 0.15927667046634097, 'n_estimators': 107}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:10,033] Trial 179 finished with value: 0.22849628109899667 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 9, 'min_child_weight': 18, 'learning_rate': 0.12623705341537572, 'subsample': 0.11661220759748947, 'n_estimators': 110}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:10,500] Trial 180 finished with value: 0.17193858824393005 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 9, 'min_child_weight': 18, 'learning_rate': 0.1334548328753175, 'subsample': 0.18580489348015145, 'n_estimators': 108}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:10,948] Trial 181 finished with value: 0.11363705474362074 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 18, 'learning_rate': 0.11127904510620688, 'subsample': 0.12255687878306622, 'n_estimators': 114}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:11,483] Trial 182 finished with value: 0.1654451783995371 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 9, 'min_child_weight': 19, 'learning_rate': 0.15553716318975166, 'subsample': 0.08278436804978649, 'n_estimators': 102}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:11,841] Trial 183 finished with value: 0.18146451462415103 and parameters: {'max_depth': 14, 'gamma': 7, 'max_delta_step': 10, 'min_child_weight': 17, 'learning_rate': 0.1266608952880876, 'subsample': 0.10843742225353097, 'n_estimators': 121}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:12,224] Trial 184 finished with value: 0.12474860093118312 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 10, 'min_child_weight': 18, 'learning_rate': 0.1837287667264946, 'subsample': 0.15709969882012761, 'n_estimators': 109}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:12,548] Trial 185 finished with value: 0.20391685624837097 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 13, 'min_child_weight': 17, 'learning_rate': 0.09283389813322843, 'subsample': 0.13670772044062932, 'n_estimators': 97}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:12,869] Trial 186 finished with value: 0.19458286728886787 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 17, 'learning_rate': 0.08274711981803509, 'subsample': 0.13729111321397622, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:13,211] Trial 187 finished with value: 0.19885672832968837 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 13, 'min_child_weight': 17, 'learning_rate': 0.07679529804677054, 'subsample': 0.14241909659009652, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:13,506] Trial 188 finished with value: 0.1867553210604448 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 17, 'learning_rate': 0.07166445127849139, 'subsample': 0.14014863993460586, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:13,934] Trial 189 finished with value: 0.19525408614710682 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 17, 'learning_rate': 0.07259437527211379, 'subsample': 0.1411562896687138, 'n_estimators': 100}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:14,252] Trial 190 finished with value: 0.1760865085323312 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 17, 'learning_rate': 0.07926813416777276, 'subsample': 0.13479602509915606, 'n_estimators': 100}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:14,587] Trial 191 finished with value: 0.1890529973782239 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 17, 'learning_rate': 0.07365923255975257, 'subsample': 0.14082885709789342, 'n_estimators': 95}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:14,949] Trial 192 finished with value: 0.1626218020892627 and parameters: {'max_depth': 13, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 17, 'learning_rate': 0.03097611272159789, 'subsample': 0.5124234523945759, 'n_estimators': 106}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:15,270] Trial 193 finished with value: 0.1733188746197999 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 17, 'learning_rate': 0.06295325663208408, 'subsample': 0.17249379266245324, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:15,569] Trial 194 finished with value: 0.1918886785489572 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 18, 'learning_rate': 0.0885760626408056, 'subsample': 0.11775911047436315, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:15,901] Trial 195 finished with value: 0.15436546177026167 and parameters: {'max_depth': 13, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 18, 'learning_rate': 0.09336851982780867, 'subsample': 0.43720210625944117, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:16,201] Trial 196 finished with value: 0.18644917567767394 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 18, 'learning_rate': 0.08957526428125294, 'subsample': 0.1153981949198405, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:16,512] Trial 197 finished with value: 0.208456939454696 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 18, 'learning_rate': 0.07064887077867618, 'subsample': 0.14217347519326337, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:16,809] Trial 198 finished with value: 0.18461721274494436 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 9, 'min_child_weight': 19, 'learning_rate': 0.10914336802776918, 'subsample': 0.09682080477355082, 'n_estimators': 100}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:17,137] Trial 199 finished with value: 0.13994526510769612 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 18, 'learning_rate': 0.09947591862411313, 'subsample': 0.06773955106662895, 'n_estimators': 105}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:17,486] Trial 200 finished with value: 0.18310143762591247 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 13, 'min_child_weight': 18, 'learning_rate': 0.05901494857648189, 'subsample': 0.12359976851863626, 'n_estimators': 110}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:17,798] Trial 201 finished with value: 0.2052880213032925 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 17, 'learning_rate': 0.07647891465863947, 'subsample': 0.14463677413549947, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:18,406] Trial 202 finished with value: 0.18576386316495963 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 17, 'learning_rate': 0.07961894146041247, 'subsample': 0.1521930509667367, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:18,723] Trial 203 finished with value: 0.19765790580582188 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 18, 'learning_rate': 0.11745666697038674, 'subsample': 0.11745214385963626, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:18,993] Trial 204 finished with value: 0.18692488287639053 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.05494722768123858, 'subsample': 0.11970797541377834, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:19,310] Trial 205 finished with value: 0.15883289774981912 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 16, 'learning_rate': 0.09884463265727231, 'subsample': 0.09393705086266291, 'n_estimators': 88}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:19,750] Trial 206 finished with value: 0.1688288007404165 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 9, 'min_child_weight': 18, 'learning_rate': 0.11554355471945627, 'subsample': 0.16901498198823245, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:20,076] Trial 207 finished with value: 0.20135164489031387 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.08792213117374043, 'subsample': 0.14724989921874035, 'n_estimators': 104}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:20,392] Trial 208 finished with value: 0.1946787699489333 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.04121705088740218, 'subsample': 0.135324321089759, 'n_estimators': 92}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:20,683] Trial 209 finished with value: 0.17173317445439273 and parameters: {'max_depth': 14, 'gamma': 2, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.02584702585564183, 'subsample': 0.14109048313391942, 'n_estimators': 92}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:20,912] Trial 210 finished with value: 0.016239046076066188 and parameters: {'max_depth': 14, 'gamma': 18, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.036630114120853256, 'subsample': 0.13669727471870316, 'n_estimators': 81}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:21,232] Trial 211 finished with value: 0.20170990477509754 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 20, 'learning_rate': 0.06608443132903333, 'subsample': 0.11057532562075406, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:21,533] Trial 212 finished with value: 0.1975859896724862 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.05850018420258775, 'subsample': 0.107614227625728, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:21,830] Trial 213 finished with value: 0.21045923178681025 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.05376070018395633, 'subsample': 0.10216659605453698, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:22,088] Trial 214 finished with value: 0.09508724864032458 and parameters: {'max_depth': 13, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.05723953697231471, 'subsample': 0.0758919587592828, 'n_estimators': 86}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:22,390] Trial 215 finished with value: 0.12981096288987715 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.019955152223645092, 'subsample': 0.0937814039809144, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:22,689] Trial 216 finished with value: 0.19103252277056015 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.04359046077180043, 'subsample': 0.10677982724450046, 'n_estimators': 88}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:22,944] Trial 217 finished with value: 0.18648269109889926 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.04774264669436122, 'subsample': 0.10330407841776384, 'n_estimators': 92}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:23,220] Trial 218 finished with value: 0.07807025631913533 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.06453388226145737, 'subsample': 0.05888885973888481, 'n_estimators': 93}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:23,567] Trial 219 finished with value: 0.19153346851602193 and parameters: {'max_depth': 14, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.0716603054436703, 'subsample': 0.11750918830407787, 'n_estimators': 99}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:23,825] Trial 220 finished with value: 0.08717786954503215 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.017094427981707773, 'subsample': 0.08736659817622677, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:24,165] Trial 221 finished with value: 0.18951364601080778 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 19, 'learning_rate': 0.07430522805013548, 'subsample': 0.13381906146787997, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:24,512] Trial 222 finished with value: 0.21081657836401935 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.08982762877684258, 'subsample': 0.12264549393884135, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:24,855] Trial 223 finished with value: 0.20532750371170005 and parameters: {'max_depth': 13, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.09710799363953308, 'subsample': 0.11783298817018928, 'n_estimators': 90}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:25,194] Trial 224 finished with value: 0.18804078727410434 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.09862772676046604, 'subsample': 0.11425835960851381, 'n_estimators': 102}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:25,469] Trial 225 finished with value: 0.13829837468243178 and parameters: {'max_depth': 16, 'gamma': 0, 'max_delta_step': 12, 'min_child_weight': 20, 'learning_rate': 0.09183172940050571, 'subsample': 0.07684526415133935, 'n_estimators': 87}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:25,784] Trial 226 finished with value: 0.17213688685990536 and parameters: {'max_depth': 13, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 19, 'learning_rate': 0.11498990606341175, 'subsample': 0.10652917287513955, 'n_estimators': 95}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:26,101] Trial 227 finished with value: -0.629577933552919 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.7197236542317325, 'subsample': 0.15362711112192837, 'n_estimators': 89}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:26,407] Trial 228 finished with value: 0.17056725160771158 and parameters: {'max_depth': 15, 'gamma': 0, 'max_delta_step': 8, 'min_child_weight': 20, 'learning_rate': 0.06998938959094145, 'subsample': 0.08556860726286525, 'n_estimators': 103}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:26,658] Trial 229 finished with value: -0.022469081026724957 and parameters: {'max_depth': 17, 'gamma': 0, 'max_delta_step': 7, 'min_child_weight': 19, 'learning_rate': 0.09127633368189865, 'subsample': 0.03538434149636116, 'n_estimators': 80}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:26,966] Trial 230 finished with value: 0.16235248129193514 and parameters: {'max_depth': 12, 'gamma': 0, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.12659800218579842, 'subsample': 0.12614610814704377, 'n_estimators': 95}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:27,242] Trial 231 finished with value: 0.2153419270005159 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.05052285835688374, 'subsample': 0.1469024349318395, 'n_estimators': 91}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:27,547] Trial 232 finished with value: 0.1899516720133385 and parameters: {'max_depth': 14, 'gamma': 1, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.055815606726912145, 'subsample': 0.17232227803508285, 'n_estimators': 90}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:27,868] Trial 233 finished with value: 0.19747244649798334 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 20, 'learning_rate': 0.07753938839600105, 'subsample': 0.14911031776657344, 'n_estimators': 97}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:28,130] Trial 234 finished with value: 0.15843254068615076 and parameters: {'max_depth': 14, 'gamma': 2, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.08040857580948374, 'subsample': 0.725824693423865, 'n_estimators': 84}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:28,420] Trial 235 finished with value: 0.1882593855490119 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 8, 'min_child_weight': 20, 'learning_rate': 0.0599416879998117, 'subsample': 0.15147236764900687, 'n_estimators': 98}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:28,713] Trial 236 finished with value: 0.17863790968105742 and parameters: {'max_depth': 15, 'gamma': 2, 'max_delta_step': 8, 'min_child_weight': 19, 'learning_rate': 0.10360381049162226, 'subsample': 0.17382189806277867, 'n_estimators': 91}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:29,138] Trial 237 finished with value: 0.18973979914770556 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.07595078635547074, 'subsample': 0.12750754469161063, 'n_estimators': 96}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:29,471] Trial 238 finished with value: 0.1929525974591183 and parameters: {'max_depth': 13, 'gamma': 1, 'max_delta_step': 9, 'min_child_weight': 19, 'learning_rate': 0.03855267343082509, 'subsample': 0.142382608877183, 'n_estimators': 106}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:29,721] Trial 239 finished with value: 0.20632052481346908 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 7, 'min_child_weight': 19, 'learning_rate': 0.09559675705921292, 'subsample': 0.10964391665164472, 'n_estimators': 86}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:30,012] Trial 240 finished with value: 0.2010516584240588 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.1099354359414785, 'subsample': 0.10993168717823724, 'n_estimators': 77}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:30,253] Trial 241 finished with value: 0.2096454509758766 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.11308899305840364, 'subsample': 0.1061992690269006, 'n_estimators': 79}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:30,514] Trial 242 finished with value: 0.19345103492660498 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.10622061516052513, 'subsample': 0.10410273387478369, 'n_estimators': 81}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:30,746] Trial 243 finished with value: 0.1924055157273764 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.08620244102031908, 'subsample': 0.1146803660593839, 'n_estimators': 75}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:30,984] Trial 244 finished with value: 0.18775314446729752 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.12027341614952346, 'subsample': 0.09723050984351653, 'n_estimators': 75}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:31,264] Trial 245 finished with value: 0.21182813900813013 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.10257410489857238, 'subsample': 0.12017280754310286, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:31,520] Trial 246 finished with value: 0.19537762852239204 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.10295500119239487, 'subsample': 0.11420294228904171, 'n_estimators': 85}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:31,780] Trial 247 finished with value: 0.07519250351869733 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 7, 'min_child_weight': 20, 'learning_rate': 0.13440963381491847, 'subsample': 0.06467011256382924, 'n_estimators': 80}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:31,997] Trial 248 finished with value: 0.15451858021586173 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.09897396490807878, 'subsample': 0.09465050515644761, 'n_estimators': 72}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:32,258] Trial 249 finished with value: 0.20980109492093746 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.11530887144593926, 'subsample': 0.12140482533343538, 'n_estimators': 78}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:32,623] Trial 250 finished with value: 0.1927964429656991 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.12481422626024793, 'subsample': 0.1244604062651614, 'n_estimators': 68}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:33,222] Trial 251 finished with value: 0.1827345646505124 and parameters: {'max_depth': 16, 'gamma': 4, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.11317877722037668, 'subsample': 0.12331411709066847, 'n_estimators': 78}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:33,451] Trial 252 finished with value: 0.08724452242100933 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.13161276609229636, 'subsample': 0.07826628253567428, 'n_estimators': 72}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:33,660] Trial 253 finished with value: 0.07081737175742353 and parameters: {'max_depth': 16, 'gamma': 10, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.0927958223333735, 'subsample': 0.09641388110231187, 'n_estimators': 86}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:33,901] Trial 254 finished with value: 0.2089483351215241 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.10925612792542935, 'subsample': 0.12682225034843395, 'n_estimators': 79}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:34,126] Trial 255 finished with value: 0.16158456875721616 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.13898542915625975, 'subsample': 0.14735737442719832, 'n_estimators': 64}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:34,368] Trial 256 finished with value: 0.22231507878529733 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.09447735269172891, 'subsample': 0.1319435786967543, 'n_estimators': 79}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:34,578] Trial 257 finished with value: 0.04174831326070294 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.4000426975678574, 'subsample': 0.05537585663801509, 'n_estimators': 77}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:34,810] Trial 258 finished with value: 0.2192425072880898 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.10321276891120926, 'subsample': 0.12913907083084605, 'n_estimators': 81}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:35,049] Trial 259 finished with value: 0.21746739346208277 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.10320841037522106, 'subsample': 0.16477128861388723, 'n_estimators': 80}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:35,299] Trial 260 finished with value: 0.22688240571349572 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.09940217000950831, 'subsample': 0.16856754316535044, 'n_estimators': 82}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:35,652] Trial 261 finished with value: 0.2065882605970758 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.09345456710289413, 'subsample': 0.17730915944640352, 'n_estimators': 81}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:35,966] Trial 262 finished with value: 0.19634828904117163 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.10263041947154004, 'subsample': 0.1843871621681237, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:36,300] Trial 263 finished with value: 0.22501859262303214 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.09800793253489476, 'subsample': 0.16961712721838484, 'n_estimators': 73}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:36,940] Trial 264 finished with value: 0.22269325447499 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.14070580597682014, 'subsample': 0.176404491087374, 'n_estimators': 71}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:37,216] Trial 265 finished with value: 0.035731571474768575 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.46728030597452236, 'subsample': 0.17976618996915308, 'n_estimators': 81}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:37,444] Trial 266 finished with value: 0.19518542458486043 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.09346205115141613, 'subsample': 0.17038379510376742, 'n_estimators': 72}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:37,680] Trial 267 finished with value: 0.21179497618069287 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.11467703005231858, 'subsample': 0.1923104606581763, 'n_estimators': 70}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:37,927] Trial 268 finished with value: 0.17182046507737048 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.14463326502532353, 'subsample': 0.20171620023806325, 'n_estimators': 70}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:38,150] Trial 269 finished with value: 0.18983734473308667 and parameters: {'max_depth': 19, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1167131843628722, 'subsample': 0.19092509296029497, 'n_estimators': 74}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:38,370] Trial 270 finished with value: 0.20408472276591194 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.11356289820259169, 'subsample': 0.16885196640017663, 'n_estimators': 60}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:38,617] Trial 271 finished with value: 0.13721273539811019 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.13878539372432858, 'subsample': 0.1840683330556991, 'n_estimators': 64}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:38,857] Trial 272 finished with value: 0.1922735956439221 and parameters: {'max_depth': 19, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.10731323614121119, 'subsample': 0.15249419955028776, 'n_estimators': 78}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:39,102] Trial 273 finished with value: 0.20665970691671753 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.08731453379883639, 'subsample': 0.17123911492323057, 'n_estimators': 69}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:39,394] Trial 274 finished with value: 0.1844942678995365 and parameters: {'max_depth': 20, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.08142508521695876, 'subsample': 0.2030444953993352, 'n_estimators': 70}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:39,624] Trial 275 finished with value: 0.1924759223251411 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.05524303912023148, 'subsample': 0.16875291661061934, 'n_estimators': 69}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:39,846] Trial 276 finished with value: 0.1603131481011495 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.13109293332605554, 'subsample': 0.18405974176110723, 'n_estimators': 66}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:40,943] Trial 277 finished with value: 0.20149356687340314 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.08792679913908477, 'subsample': 0.1717648067091553, 'n_estimators': 74}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:41,240] Trial 278 finished with value: 0.1973473702469295 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.07164182269353378, 'subsample': 0.16124461005429894, 'n_estimators': 82}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:41,628] Trial 279 finished with value: 0.20761444545685626 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.15119871712767613, 'subsample': 0.1313362380806789, 'n_estimators': 76}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:41,873] Trial 280 finished with value: 0.07170181065271974 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.5358721125880194, 'subsample': 0.12846867830920294, 'n_estimators': 75}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:42,095] Trial 281 finished with value: 0.1820411195899886 and parameters: {'max_depth': 18, 'gamma': 4, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.15565428792938962, 'subsample': 0.12930223842709213, 'n_estimators': 79}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:42,363] Trial 282 finished with value: 0.12270009999098042 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.14395833966616617, 'subsample': 0.47735083274940227, 'n_estimators': 83}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:42,714] Trial 283 finished with value: 0.19655575065072795 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.11934906268756673, 'subsample': 0.16210935660209808, 'n_estimators': 65}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:43,089] Trial 284 finished with value: 0.12295072121976058 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.12655414283027427, 'subsample': 0.21192765445821937, 'n_estimators': 58}. Best is trial 113 with value: 0.2289092424234367.\n",
      "[I 2025-02-07 15:29:43,690] Trial 285 finished with value: 0.23316060139749872 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.1459993640715904, 'subsample': 0.13257544772436078, 'n_estimators': 71}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:43,936] Trial 286 finished with value: 0.21478565707352937 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.15536190491177213, 'subsample': 0.1598278903682284, 'n_estimators': 70}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:44,167] Trial 287 finished with value: 0.18811896851926801 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.1409581070508835, 'subsample': 0.191467959380817, 'n_estimators': 70}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:44,384] Trial 288 finished with value: 0.20180865656777514 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.15289659860368288, 'subsample': 0.16361561576355751, 'n_estimators': 67}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:44,601] Trial 289 finished with value: 0.13101963355792023 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 0, 'min_child_weight': 19, 'learning_rate': 0.15688280071785607, 'subsample': 0.18636213955974062, 'n_estimators': 74}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:44,844] Trial 290 finished with value: 0.20239875438088484 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.13159950101425388, 'subsample': 0.13726162167958683, 'n_estimators': 77}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:45,094] Trial 291 finished with value: 0.10655355865655625 and parameters: {'max_depth': 17, 'gamma': 14, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.11484151196057471, 'subsample': 0.16072041634685758, 'n_estimators': 72}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:45,309] Trial 292 finished with value: 0.05250357519539317 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 6, 'learning_rate': 0.16484754000494833, 'subsample': 0.2168591052566604, 'n_estimators': 61}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:45,554] Trial 293 finished with value: 0.16669589634358495 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.1058457270732246, 'subsample': 0.8679899029435582, 'n_estimators': 84}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:45,817] Trial 294 finished with value: 0.1984278792655424 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.12938997359437657, 'subsample': 0.13843543306283798, 'n_estimators': 80}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:46,044] Trial 295 finished with value: 0.18776240581094183 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 19, 'learning_rate': 0.14679377708371594, 'subsample': 0.1560684542446538, 'n_estimators': 68}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:46,267] Trial 296 finished with value: 0.14264852059768185 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.045243343806446734, 'subsample': 0.17724313403177314, 'n_estimators': 53}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:46,493] Trial 297 finished with value: 0.17817801996181915 and parameters: {'max_depth': 19, 'gamma': 3, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.09650401525790396, 'subsample': 0.13004808189253597, 'n_estimators': 77}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:46,715] Trial 298 finished with value: 0.1859689152526155 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.06409137403322104, 'subsample': 0.19583067150150435, 'n_estimators': 73}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:46,980] Trial 299 finished with value: 0.18807222020300995 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.12025107657237649, 'subsample': 0.14805043432017176, 'n_estimators': 85}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:47,236] Trial 300 finished with value: -0.04784924602725171 and parameters: {'max_depth': 18, 'gamma': 4, 'max_delta_step': 0, 'min_child_weight': 19, 'learning_rate': 0.8965127794834643, 'subsample': 0.12605356392977293, 'n_estimators': 81}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:47,450] Trial 301 finished with value: 0.08390776055052296 and parameters: {'max_depth': 17, 'gamma': 11, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.08762553225049714, 'subsample': 0.58860204160638, 'n_estimators': 67}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:47,694] Trial 302 finished with value: 0.2139556212084267 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.11074658569157811, 'subsample': 0.16690395521902507, 'n_estimators': 77}. Best is trial 285 with value: 0.23316060139749872.\n",
      "[I 2025-02-07 15:29:47,943] Trial 303 finished with value: 0.24142673231726142 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1673266351389645, 'subsample': 0.17794938759715506, 'n_estimators': 74}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:48,158] Trial 304 finished with value: 0.1294537175466861 and parameters: {'max_depth': 20, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1741694954674642, 'subsample': 0.22375128464526045, 'n_estimators': 62}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:48,430] Trial 305 finished with value: 0.22509357821394338 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.1750419338854844, 'subsample': 0.1652129899182215, 'n_estimators': 72}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:48,673] Trial 306 finished with value: 0.17057681367671385 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.16488485501834782, 'subsample': 0.1953742330600822, 'n_estimators': 73}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:48,908] Trial 307 finished with value: 0.20591585147935298 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.15001504375634458, 'subsample': 0.14860094538000054, 'n_estimators': 77}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:49,128] Trial 308 finished with value: 0.1977359941303677 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.19071404917122625, 'subsample': 0.16720117409367558, 'n_estimators': 74}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:49,362] Trial 309 finished with value: 0.19502292593128412 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.17509031480568646, 'subsample': 0.14028546932921768, 'n_estimators': 77}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:49,585] Trial 310 finished with value: 0.19135250231786416 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1478646545567885, 'subsample': 0.15680357836597797, 'n_estimators': 65}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:49,845] Trial 311 finished with value: -0.5538064775508806 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.8187608671728047, 'subsample': 0.1256467136460972, 'n_estimators': 72}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:50,081] Trial 312 finished with value: 0.1909532950384818 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.13462833125428936, 'subsample': 0.18189055096876772, 'n_estimators': 86}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:50,354] Trial 313 finished with value: 0.1801912549461282 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.16286561611720318, 'subsample': 0.20254725241631727, 'n_estimators': 80}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:50,557] Trial 314 finished with value: 0.018003837428039682 and parameters: {'max_depth': 19, 'gamma': 15, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.12066197693754156, 'subsample': 0.09266057942795958, 'n_estimators': 70}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:51,057] Trial 315 finished with value: 0.21378194355038715 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.146046937895516, 'subsample': 0.15362853305138735, 'n_estimators': 242}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:51,311] Trial 316 finished with value: 0.21283148475844937 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.13089312044133933, 'subsample': 0.15841971593791007, 'n_estimators': 88}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:51,573] Trial 317 finished with value: 0.18551540650654663 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.18881962169875424, 'subsample': 0.1601146738465023, 'n_estimators': 87}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:51,866] Trial 318 finished with value: 0.16731364286683537 and parameters: {'max_depth': 16, 'gamma': 7, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.14353366769510054, 'subsample': 0.23591154393273445, 'n_estimators': 181}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:52,257] Trial 319 finished with value: 0.11005415283142272 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.12455050318279753, 'subsample': 0.623274656339082, 'n_estimators': 250}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:52,726] Trial 320 finished with value: -3.11064141332921 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.9424831775970319, 'subsample': 0.18403261103508983, 'n_estimators': 218}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:53,198] Trial 321 finished with value: 0.15997606311890344 and parameters: {'max_depth': 16, 'gamma': 4, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.11588028006183382, 'subsample': 0.20941873873041356, 'n_estimators': 234}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:53,443] Trial 322 finished with value: 0.23772126796078386 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.15890506056996045, 'subsample': 0.1627983857975116, 'n_estimators': 83}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:53,787] Trial 323 finished with value: 0.1408526143628217 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.17013123285869766, 'subsample': 0.1698858310512856, 'n_estimators': 168}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:54,015] Trial 324 finished with value: 0.1962568593972357 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.18019942002208356, 'subsample': 0.19262214127031274, 'n_estimators': 84}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:54,381] Trial 325 finished with value: 0.1731053235255654 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.20314835373107396, 'subsample': 0.15643436991612525, 'n_estimators': 188}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:54,633] Trial 326 finished with value: -0.051217286753817426 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.6542598446680745, 'subsample': 0.16869548279648627, 'n_estimators': 87}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:54,857] Trial 327 finished with value: 0.15304441372153188 and parameters: {'max_depth': 16, 'gamma': 5, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.13790808851178288, 'subsample': 0.15197738632322108, 'n_estimators': 82}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:55,051] Trial 328 finished with value: 0.08413952388589863 and parameters: {'max_depth': 17, 'gamma': 16, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.16330877466153076, 'subsample': 0.18013822877726043, 'n_estimators': 62}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:55,362] Trial 329 finished with value: 0.1788599120164749 and parameters: {'max_depth': 16, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.15065911513271382, 'subsample': 0.2097706014246942, 'n_estimators': 89}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:55,592] Trial 330 finished with value: 0.14412261599828347 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.12353918731867648, 'subsample': 0.9695296006271643, 'n_estimators': 78}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:55,872] Trial 331 finished with value: 0.19701374988321363 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.14480094134459287, 'subsample': 0.14425218933315853, 'n_estimators': 71}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:56,175] Trial 332 finished with value: 0.1708008156425863 and parameters: {'max_depth': 15, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.16741265823134985, 'subsample': 0.11187753942093706, 'n_estimators': 57}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:56,412] Trial 333 finished with value: 0.15974410667758498 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.13235807217658496, 'subsample': 0.1885121756198406, 'n_estimators': 82}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:56,637] Trial 334 finished with value: 0.19332050828422231 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.1138186875597747, 'subsample': 0.15745531221021508, 'n_estimators': 66}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:57,015] Trial 335 finished with value: 0.18283449697783505 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.13814546071217176, 'subsample': 0.13226428504690307, 'n_estimators': 202}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:57,225] Trial 336 finished with value: 0.1472798640301758 and parameters: {'max_depth': 16, 'gamma': 4, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.19318787829683054, 'subsample': 0.1749581928609208, 'n_estimators': 73}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:57,472] Trial 337 finished with value: 0.12461262602307421 and parameters: {'max_depth': 15, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.11171984104263766, 'subsample': 0.07982553311627563, 'n_estimators': 89}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:57,692] Trial 338 finished with value: 0.20465712195169605 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 6, 'min_child_weight': 19, 'learning_rate': 0.15940051881328146, 'subsample': 0.10950740661743016, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:57,939] Trial 339 finished with value: 0.15711703728220427 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 11, 'learning_rate': 0.10298679797102739, 'subsample': 0.14365483588323733, 'n_estimators': 83}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:58,344] Trial 340 finished with value: 0.20463632026767975 and parameters: {'max_depth': 17, 'gamma': 8, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1372554351327887, 'subsample': 0.15922432430687336, 'n_estimators': 79}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:58,695] Trial 341 finished with value: 0.18417703214713477 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.181037294204336, 'subsample': 0.20211751454959312, 'n_estimators': 68}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:58,965] Trial 342 finished with value: 0.2260665188144685 and parameters: {'max_depth': 20, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.10193000221179889, 'subsample': 0.12319425439321025, 'n_estimators': 87}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:29:59,741] Trial 343 finished with value: 0.2006259957717479 and parameters: {'max_depth': 20, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.07962745277016117, 'subsample': 0.13009603255604277, 'n_estimators': 87}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:00,043] Trial 344 finished with value: 0.19352830126722553 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.0306792171459504, 'subsample': 0.17253330952388793, 'n_estimators': 90}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:00,407] Trial 345 finished with value: -0.9869658174384011 and parameters: {'max_depth': 19, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.7642817075287357, 'subsample': 0.22854526116766394, 'n_estimators': 149}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:00,622] Trial 346 finished with value: 0.12430482831340539 and parameters: {'max_depth': 18, 'gamma': 9, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.10571962218227539, 'subsample': 0.14866316976632746, 'n_estimators': 85}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:00,911] Trial 347 finished with value: -0.1568305139286943 and parameters: {'max_depth': 20, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 1, 'learning_rate': 0.15828755653263288, 'subsample': 0.12344155977826154, 'n_estimators': 90}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:01,171] Trial 348 finished with value: 0.20135204815040775 and parameters: {'max_depth': 15, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.06057603340262137, 'subsample': 0.1834309123188746, 'n_estimators': 74}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:01,414] Trial 349 finished with value: 0.19374562745620083 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.12970127944405271, 'subsample': 0.14620182757199246, 'n_estimators': 83}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:01,644] Trial 350 finished with value: 0.043260173795303225 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.006453785419844912, 'subsample': 0.09449452748688754, 'n_estimators': 64}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:01,893] Trial 351 finished with value: 0.16184027071931673 and parameters: {'max_depth': 2, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.08897441717133403, 'subsample': 0.16362477756081922, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:02,141] Trial 352 finished with value: 0.21170707533270294 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1235396606174533, 'subsample': 0.13110784150345728, 'n_estimators': 70}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:02,437] Trial 353 finished with value: 0.12775287764140064 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1476972748292404, 'subsample': 0.39176514095900083, 'n_estimators': 70}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:02,702] Trial 354 finished with value: 0.029320118406382045 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 3, 'min_child_weight': 8, 'learning_rate': 0.17469183938169788, 'subsample': 0.13778154041036056, 'n_estimators': 61}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:03,250] Trial 355 finished with value: 0.06797555939478939 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.2130702428346018, 'subsample': 0.1874202379002991, 'n_estimators': 241}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:03,521] Trial 356 finished with value: 0.17184414639153822 and parameters: {'max_depth': 19, 'gamma': 1, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.04725584823083956, 'subsample': 0.20755677448864268, 'n_estimators': 69}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:03,787] Trial 357 finished with value: 0.19379093725272856 and parameters: {'max_depth': 20, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.09927088299110287, 'subsample': 0.1650400287806378, 'n_estimators': 92}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:04,086] Trial 358 finished with value: 0.1974326612928814 and parameters: {'max_depth': 20, 'gamma': 1, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.12880372427801454, 'subsample': 0.12275977839962543, 'n_estimators': 85}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:04,331] Trial 359 finished with value: 0.2052463942665017 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.06252778143435442, 'subsample': 0.15400171522304318, 'n_estimators': 73}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:04,626] Trial 360 finished with value: 0.16423469035595128 and parameters: {'max_depth': 19, 'gamma': 1, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.08040037104626513, 'subsample': 0.09541900500172114, 'n_estimators': 81}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:04,856] Trial 361 finished with value: 0.17749366807206357 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 6, 'min_child_weight': 20, 'learning_rate': 0.15477287234185025, 'subsample': 0.13897528944698703, 'n_estimators': 66}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:05,158] Trial 362 finished with value: 0.2196821628610418 and parameters: {'max_depth': 18, 'gamma': 1, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.12509549609797566, 'subsample': 0.18140100388796707, 'n_estimators': 89}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:05,428] Trial 363 finished with value: 0.2134125000262319 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.1284286443132965, 'subsample': 0.2183567887671585, 'n_estimators': 88}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:05,718] Trial 364 finished with value: 0.15493232255840317 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.13890535971613072, 'subsample': 0.2415876583772394, 'n_estimators': 88}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:05,995] Trial 365 finished with value: 0.15141679536901398 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 19, 'learning_rate': 0.18637771232909095, 'subsample': 0.22736299255915737, 'n_estimators': 82}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:06,296] Trial 366 finished with value: 0.17741134059324204 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.16082055742475987, 'subsample': 0.20485954177330817, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:06,514] Trial 367 finished with value: 0.140223869214536 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.1223045810204558, 'subsample': 0.18951265606708315, 'n_estimators': 58}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:06,747] Trial 368 finished with value: 0.16434683788356363 and parameters: {'max_depth': 19, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.1342952841407854, 'subsample': 0.18928755005978298, 'n_estimators': 86}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:06,981] Trial 369 finished with value: 0.13798823323470377 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 18, 'learning_rate': 0.17089381449102486, 'subsample': 0.21444697609125815, 'n_estimators': 72}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:07,237] Trial 370 finished with value: 0.201519744185935 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 19, 'learning_rate': 0.12104015736676882, 'subsample': 0.1716963629741504, 'n_estimators': 80}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:07,539] Trial 371 finished with value: 0.1700377099147291 and parameters: {'max_depth': 19, 'gamma': 1, 'max_delta_step': 2, 'min_child_weight': 19, 'learning_rate': 0.1461450181880333, 'subsample': 0.1754019188812147, 'n_estimators': 90}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:07,811] Trial 372 finished with value: 0.16099452436690553 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.10601418681992839, 'subsample': 0.19376753686195977, 'n_estimators': 83}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:08,022] Trial 373 finished with value: 0.013550614316340637 and parameters: {'max_depth': 17, 'gamma': 13, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.1267970655288059, 'subsample': 0.17088646516784392, 'n_estimators': 66}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:08,320] Trial 374 finished with value: 0.15740259501122722 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 19, 'learning_rate': 0.15150830732070836, 'subsample': 0.21387221598826972, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:08,608] Trial 375 finished with value: 0.2080124550446082 and parameters: {'max_depth': 18, 'gamma': 1, 'max_delta_step': 3, 'min_child_weight': 20, 'learning_rate': 0.1069489466741757, 'subsample': 0.153248682387029, 'n_estimators': 90}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:08,871] Trial 376 finished with value: -0.200054119411182 and parameters: {'max_depth': 19, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.5903197628472884, 'subsample': 0.1886240150564747, 'n_estimators': 80}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:09,125] Trial 377 finished with value: 0.13087238091976172 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 4, 'min_child_weight': 19, 'learning_rate': 0.19369832650077373, 'subsample': 0.5345843656252881, 'n_estimators': 71}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:09,395] Trial 378 finished with value: 0.17597228104228457 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.1731017135807318, 'subsample': 0.26011443101821174, 'n_estimators': 87}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:09,668] Trial 379 finished with value: 0.22323033561650807 and parameters: {'max_depth': 17, 'gamma': 1, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.13814447014232475, 'subsample': 0.15853749800975714, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:09,971] Trial 380 finished with value: 0.17266455430802774 and parameters: {'max_depth': 17, 'gamma': 1, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.14409009670298362, 'subsample': 0.16075717867836334, 'n_estimators': 83}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:10,209] Trial 381 finished with value: 0.17788165198532835 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.16171763060270547, 'subsample': 0.20263267831651188, 'n_estimators': 78}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:10,476] Trial 382 finished with value: 0.2072699346855198 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 18, 'learning_rate': 0.10882083280889815, 'subsample': 0.17831977099521726, 'n_estimators': 86}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:10,867] Trial 383 finished with value: 0.187311955198177 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.210621217124872, 'subsample': 0.15413381042411456, 'n_estimators': 92}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:11,302] Trial 384 finished with value: 0.2020782279387756 and parameters: {'max_depth': 17, 'gamma': 4, 'max_delta_step': 0, 'min_child_weight': 19, 'learning_rate': 0.13821174183712157, 'subsample': 0.2297774852158483, 'n_estimators': 75}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:11,605] Trial 385 finished with value: 0.1950919192004349 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.09866309170992946, 'subsample': 0.16820580243070143, 'n_estimators': 80}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:11,875] Trial 386 finished with value: 0.20230585282702607 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 19, 'learning_rate': 0.18031038459470905, 'subsample': 0.19070233819344556, 'n_estimators': 86}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:12,174] Trial 387 finished with value: 0.20951016288834123 and parameters: {'max_depth': 18, 'gamma': 3, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.15700720162317103, 'subsample': 0.1534778075143805, 'n_estimators': 75}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:12,454] Trial 388 finished with value: 0.17588910943026093 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 3, 'min_child_weight': 18, 'learning_rate': 0.12277115143523437, 'subsample': 0.175573096735262, 'n_estimators': 63}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:12,766] Trial 389 finished with value: -2.1309645042882037 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 10, 'learning_rate': 0.8620863506239347, 'subsample': 0.1422683777039357, 'n_estimators': 54}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:13,560] Trial 390 finished with value: 0.17818359553983 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 2, 'min_child_weight': 20, 'learning_rate': 0.08634075374437485, 'subsample': 0.22038659462018562, 'n_estimators': 91}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:13,898] Trial 391 finished with value: 0.1791711454126983 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 19, 'learning_rate': 0.13592004372806038, 'subsample': 0.19889990387319845, 'n_estimators': 82}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:14,185] Trial 392 finished with value: 0.12339977526029877 and parameters: {'max_depth': 17, 'gamma': 1, 'max_delta_step': 3, 'min_child_weight': 9, 'learning_rate': 0.10538907626825339, 'subsample': 0.15807702063043855, 'n_estimators': 72}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:14,489] Trial 393 finished with value: 0.18872630018244785 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 1, 'min_child_weight': 20, 'learning_rate': 0.16032875061607846, 'subsample': 0.13921197345848177, 'n_estimators': 76}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:14,766] Trial 394 finished with value: 0.08124970545955956 and parameters: {'max_depth': 12, 'gamma': 2, 'max_delta_step': 5, 'min_child_weight': 12, 'learning_rate': 0.12349380451363544, 'subsample': 0.17211583614262843, 'n_estimators': 67}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:15,121] Trial 395 finished with value: 0.19440864940113234 and parameters: {'max_depth': 17, 'gamma': 2, 'max_delta_step': 4, 'min_child_weight': 20, 'learning_rate': 0.08203382902809463, 'subsample': 0.13979815620518524, 'n_estimators': 158}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:15,362] Trial 396 finished with value: 0.14119787949906215 and parameters: {'max_depth': 16, 'gamma': 3, 'max_delta_step': 3, 'min_child_weight': 19, 'learning_rate': 0.1462195544758836, 'subsample': 0.1878750110301122, 'n_estimators': 84}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:15,616] Trial 397 finished with value: 0.1972232506792403 and parameters: {'max_depth': 17, 'gamma': 3, 'max_delta_step': 5, 'min_child_weight': 20, 'learning_rate': 0.1032302198146959, 'subsample': 0.11692645743709207, 'n_estimators': 80}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:15,947] Trial 398 finished with value: 0.1675056028471743 and parameters: {'max_depth': 18, 'gamma': 2, 'max_delta_step': 0, 'min_child_weight': 20, 'learning_rate': 0.17635976653628224, 'subsample': 0.15859217935894734, 'n_estimators': 139}. Best is trial 303 with value: 0.24142673231726142.\n",
      "[I 2025-02-07 15:30:16,263] Trial 399 finished with value: 0.14373843480362825 and parameters: {'max_depth': 16, 'gamma': 1, 'max_delta_step': 2, 'min_child_weight': 19, 'learning_rate': 0.19401878699701447, 'subsample': 0.17659897219917517, 'n_estimators': 92}. Best is trial 303 with value: 0.24142673231726142.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "{'max_depth': 16,\n",
       " 'gamma': 2,\n",
       " 'max_delta_step': 4,\n",
       " 'min_child_weight': 20,\n",
       " 'learning_rate': 0.1673266351389645,\n",
       " 'subsample': 0.17794938759715506,\n",
       " 'n_estimators': 74}"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from qsprpred.models import OptunaOptimization, TestSetAssessor\n",
    "from sklearn.model_selection import KFold\n",
    "\n",
    "# Note the specification of the hyperparameter types as first item in the list\n",
    "search_space = {\"max_depth\": [\"int\", 1, 20],\n",
    "                \"gamma\": [\"int\", 0, 20],\n",
    "                \"max_delta_step\": [\"int\", 0, 20],\n",
    "                \"min_child_weight\": [\"int\", 1, 20],\n",
    "                \"learning_rate\": [\"float\", 0.001, 1],\n",
    "                \"subsample\": [\"float\", 0.001, 1],\n",
    "                \"n_estimators\": [\"int\", 10, 250],\n",
    "               }\n",
    "\n",
    "# Optuna gridsearcher with the TestSetAssessor\n",
    "gridsearcher = OptunaOptimization(\n",
    "    n_trials=400,\n",
    "    param_grid=search_space,\n",
    "    model_assessor=TestSetAssessor(scoring='r2'),\n",
    ")\n",
    "gridsearcher.optimize(model_mers, dataset_mers)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6f993b59-d135-439c-8d22-711d9d7d52de",
   "metadata": {},
   "source": [
    "{'max_depth': 16,\n",
    " 'gamma': 2,\n",
    " 'max_delta_step': 4,\n",
    " 'min_child_weight': 20,\n",
    " 'learning_rate': 0.1673266351389645,\n",
    " 'subsample': 0.17794938759715506,\n",
    " 'n_estimators': 74}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "16af9b01-5d25-4382-b4f4-a15c27445e85",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['accuracy', 'adjusted_mutual_info_score', 'adjusted_rand_score', 'average_precision', 'balanced_accuracy', 'completeness_score', 'explained_variance', 'f1', 'f1_macro', 'f1_micro', 'f1_samples', 'f1_weighted', 'fowlkes_mallows_score', 'homogeneity_score', 'jaccard', 'jaccard_macro', 'jaccard_micro', 'jaccard_samples', 'jaccard_weighted', 'matthews_corrcoef', 'max_error', 'mutual_info_score', 'neg_brier_score', 'neg_log_loss', 'neg_mean_absolute_error', 'neg_mean_absolute_percentage_error', 'neg_mean_gamma_deviance', 'neg_mean_poisson_deviance', 'neg_mean_squared_error', 'neg_mean_squared_log_error', 'neg_median_absolute_error', 'neg_negative_likelihood_ratio', 'neg_root_mean_squared_error', 'neg_root_mean_squared_log_error', 'normalized_mutual_info_score', 'positive_likelihood_ratio', 'precision', 'precision_macro', 'precision_micro', 'precision_samples', 'precision_weighted', 'r2', 'rand_score', 'recall', 'recall_macro', 'recall_micro', 'recall_samples', 'recall_weighted', 'roc_auc', 'roc_auc_ovo', 'roc_auc_ovo_weighted', 'roc_auc_ovr', 'roc_auc_ovr_weighted', 'top_k_accuracy', 'v_measure_score']\n"
     ]
    }
   ],
   "source": [
    "# We can now assess the model performance on the training set using cross validation\n",
    "from sklearn.metrics import mean_squared_error\n",
    "import sklearn\n",
    "from sklearn import metrics\n",
    "\n",
    "print(sklearn.metrics.get_scorer_names())\n",
    "\n",
    "CrossValAssessor(\n",
    "    scoring=\"neg_mean_absolute_error\",\n",
    "    split=BootstrapSplit(split=ClusterSplit(dataset_mers), n_bootstraps=100)\n",
    ")(model_mers, dataset_mers)\n",
    "\n",
    "# and on the test set\n",
    "TestSetAssessor(\"neg_mean_absolute_error\")(model_mers, dataset_mers)\n",
    "\n",
    "# Finally, we need to fit the model on the complete dataset if we want to use it further\n",
    "model_mers.fitDataset(dataset_mers)\n",
    "\n",
    "# and save the model\n",
    "_ = model_mers.save()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a893339f-5368-42e2-9ac1-e5e8ef7094cd",
   "metadata": {},
   "outputs": [],
   "source": [
    "from rdkit import Chem\n",
    "from rdkit.Chem import MolStandardize\n",
    "\n",
    "def read_smi_file(file_path):\n",
    "    smiles_list = []\n",
    "    try:\n",
    "        with open(file_path, 'r') as file:\n",
    "            for line in file:\n",
    "                # Skip comment lines and empty lines\n",
    "                if line.strip() and not line.startswith('#'):\n",
    "                    # SMILES strings are typically separated by whitespace or tab\n",
    "                    smiles = line.split()[0]\n",
    "                    smiles_list.append(smiles)\n",
    "    except FileNotFoundError:\n",
    "        print(\"File not found.\")\n",
    "    return smiles_list\n",
    "\n",
    "# Example usage to read the standardized SMILES file and create a list\n",
    "file_path = 'test_potency.smi'\n",
    "smiles_list = read_smi_file(file_path)\n",
    "print(\"SMILES in the file:\")\n",
    "print(len(smiles_list))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "797b6f77-5ea6-4a7b-addc-54270f088374",
   "metadata": {},
   "outputs": [],
   "source": [
    "well = model_mers.predictMols(smiles_list_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "e35f6463-9b4b-4e65-a1c0-10c97ae36e71",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[5.320606 ]\n",
      " [5.2716703]\n",
      " [5.059407 ]\n",
      " [5.1448517]\n",
      " [5.284195 ]\n",
      " [5.2422705]\n",
      " [5.368682 ]\n",
      " [5.3890457]\n",
      " [5.09416  ]\n",
      " [5.0523124]\n",
      " [5.008095 ]\n",
      " [5.4924116]\n",
      " [5.317238 ]\n",
      " [5.3535748]\n",
      " [5.489856 ]\n",
      " [5.3856745]\n",
      " [5.1945477]\n",
      " [4.9230795]\n",
      " [4.5703797]\n",
      " [5.1945477]\n",
      " [5.310707 ]\n",
      " [5.5732174]\n",
      " [5.90456  ]\n",
      " [5.951708 ]\n",
      " [4.988575 ]\n",
      " [5.777872 ]\n",
      " [5.2126884]\n",
      " [5.6973   ]\n",
      " [5.5732174]\n",
      " [5.0983877]\n",
      " [5.310707 ]\n",
      " [5.2226267]\n",
      " [5.569541 ]\n",
      " [5.7737846]\n",
      " [5.7737846]\n",
      " [5.859026 ]\n",
      " [5.4277925]\n",
      " [5.4277925]\n",
      " [5.310707 ]\n",
      " [5.0386257]\n",
      " [5.4612246]\n",
      " [6.0134506]\n",
      " [5.2927275]\n",
      " [5.2927275]\n",
      " [5.5598526]\n",
      " [5.5598526]\n",
      " [5.412199 ]\n",
      " [5.412199 ]\n",
      " [5.3541775]\n",
      " [5.3541775]\n",
      " [5.570532 ]\n",
      " [5.310707 ]\n",
      " [5.586858 ]\n",
      " [5.717229 ]\n",
      " [5.4824514]\n",
      " [5.656699 ]\n",
      " [5.656699 ]\n",
      " [5.3782187]\n",
      " [5.154785 ]\n",
      " [5.310707 ]\n",
      " [5.636894 ]\n",
      " [5.568618 ]\n",
      " [5.568618 ]\n",
      " [5.656699 ]\n",
      " [5.310707 ]\n",
      " [5.310707 ]\n",
      " [5.8662004]\n",
      " [5.8747177]\n",
      " [5.5087624]\n",
      " [5.689556 ]\n",
      " [5.6969585]\n",
      " [5.932081 ]\n",
      " [5.8662004]\n",
      " [5.656699 ]\n",
      " [5.322341 ]\n",
      " [5.511917 ]\n",
      " [5.7902985]\n",
      " [5.7984476]\n",
      " [5.656699 ]\n",
      " [5.8204584]\n",
      " [5.5533333]\n",
      " [5.5153084]\n",
      " [6.170492 ]\n",
      " [5.656699 ]\n",
      " [6.170492 ]\n",
      " [6.1144114]\n",
      " [5.310707 ]\n",
      " [5.8597145]\n",
      " [5.329629 ]\n",
      " [5.310707 ]\n",
      " [5.777872 ]\n",
      " [5.8662004]\n",
      " [5.777872 ]\n",
      " [5.819627 ]\n",
      " [5.3081512]\n",
      " [5.81073  ]\n",
      " [5.81073  ]\n",
      " [5.8633804]\n",
      " [5.777872 ]\n",
      " [5.7191763]\n",
      " [5.777872 ]\n",
      " [5.722163 ]\n",
      " [5.819627 ]\n",
      " [5.777872 ]\n",
      " [5.6903343]\n",
      " [5.7040815]\n",
      " [5.82712  ]\n",
      " [5.858508 ]\n",
      " [6.210511 ]\n",
      " [5.159464 ]\n",
      " [5.2929363]\n",
      " [6.1123486]\n",
      " [5.2422705]\n",
      " [5.932081 ]\n",
      " [5.2166834]\n",
      " [5.777872 ]\n",
      " [5.2166834]\n",
      " [5.2166834]\n",
      " [5.148247 ]\n",
      " [4.5954304]\n",
      " [4.5954304]\n",
      " [5.969017 ]\n",
      " [5.148247 ]\n",
      " [5.995263 ]\n",
      " [5.148247 ]\n",
      " [4.5954304]\n",
      " [5.2166834]\n",
      " [5.2166834]\n",
      " [4.69218  ]\n",
      " [4.846346 ]\n",
      " [5.858508 ]\n",
      " [4.8939314]\n",
      " [5.074649 ]\n",
      " [4.761406 ]\n",
      " [4.372012 ]\n",
      " [4.808857 ]\n",
      " [4.9023666]\n",
      " [4.80898  ]\n",
      " [4.5442076]\n",
      " [4.4102573]\n",
      " [4.775042 ]\n",
      " [4.4092307]\n",
      " [4.462623 ]\n",
      " [4.952179 ]\n",
      " [5.127536 ]\n",
      " [4.6680193]\n",
      " [4.9023666]\n",
      " [4.9013677]\n",
      " [4.462623 ]\n",
      " [4.3791895]\n",
      " [5.30056  ]\n",
      " [4.8447943]\n",
      " [4.8447943]\n",
      " [4.9308953]\n",
      " [4.894613 ]\n",
      " [4.936644 ]\n",
      " [5.114984 ]\n",
      " [4.4130044]\n",
      " [5.1169605]\n",
      " [5.1169605]\n",
      " [4.462623 ]\n",
      " [4.287398 ]\n",
      " [4.4563904]\n",
      " [4.514545 ]\n",
      " [4.7014904]\n",
      " [4.81493  ]\n",
      " [4.462623 ]\n",
      " [4.598121 ]\n",
      " [4.8791246]\n",
      " [4.764301 ]\n",
      " [5.1833744]\n",
      " [4.736542 ]\n",
      " [4.7995963]\n",
      " [4.639909 ]\n",
      " [6.1021833]\n",
      " [4.663885 ]\n",
      " [4.5040636]\n",
      " [6.099784 ]\n",
      " [4.584469 ]\n",
      " [6.181488 ]\n",
      " [4.686024 ]\n",
      " [4.936644 ]\n",
      " [6.2049227]\n",
      " [4.511265 ]\n",
      " [6.132676 ]\n",
      " [6.2354155]\n",
      " [4.7717447]\n",
      " [4.6545105]\n",
      " [5.036561 ]\n",
      " [4.5309515]\n",
      " [4.437344 ]\n",
      " [4.560497 ]\n",
      " [4.353427 ]\n",
      " [4.7147365]\n",
      " [5.0744343]\n",
      " [4.7623076]\n",
      " [4.96094  ]\n",
      " [4.6688447]\n",
      " [4.662233 ]\n",
      " [5.137554 ]\n",
      " [5.137554 ]\n",
      " [4.7117896]\n",
      " [4.6879983]\n",
      " [4.4249716]\n",
      " [4.5875573]\n",
      " [4.72059  ]\n",
      " [4.491992 ]\n",
      " [4.5525494]\n",
      " [4.72059  ]\n",
      " [4.685781 ]\n",
      " [4.9795446]\n",
      " [4.537063 ]\n",
      " [4.7474356]\n",
      " [4.7474356]\n",
      " [4.210187 ]\n",
      " [4.210187 ]\n",
      " [4.6013193]\n",
      " [4.6013193]\n",
      " [4.9672966]\n",
      " [4.598905 ]\n",
      " [4.598905 ]\n",
      " [4.795403 ]\n",
      " [4.795403 ]\n",
      " [4.491992 ]\n",
      " [4.3602347]\n",
      " [4.5604734]\n",
      " [4.883171 ]\n",
      " [4.883171 ]\n",
      " [4.717496 ]\n",
      " [4.885735 ]\n",
      " [4.885735 ]\n",
      " [4.7076464]\n",
      " [4.7076464]\n",
      " [4.6885495]\n",
      " [4.7441974]\n",
      " [4.834374 ]\n",
      " [4.8066473]\n",
      " [4.8066473]\n",
      " [4.835931 ]\n",
      " [4.480832 ]\n",
      " [4.5871286]\n",
      " [4.6804814]\n",
      " [4.6804814]\n",
      " [4.5366178]\n",
      " [4.7556086]\n",
      " [5.014467 ]\n",
      " [4.8342733]\n",
      " [4.525578 ]\n",
      " [4.680826 ]\n",
      " [4.555725 ]\n",
      " [4.9001956]\n",
      " [4.922795 ]\n",
      " [4.922795 ]\n",
      " [4.81493  ]\n",
      " [4.4441743]\n",
      " [4.841322 ]\n",
      " [4.8619003]\n",
      " [4.9672966]\n",
      " [4.5604734]\n",
      " [4.4746227]\n",
      " [4.462974 ]\n",
      " [4.4292645]\n",
      " [4.7282076]\n",
      " [4.6118264]\n",
      " [4.8006296]\n",
      " [4.99917  ]\n",
      " [4.6403127]\n",
      " [4.6403127]\n",
      " [4.5070257]\n",
      " [4.6245437]\n",
      " [4.547695 ]\n",
      " [4.5387697]\n",
      " [4.7893066]\n",
      " [4.581808 ]\n",
      " [4.56289  ]\n",
      " [4.644384 ]\n",
      " [4.3093224]\n",
      " [4.5347176]\n",
      " [4.5347176]\n",
      " [4.5347176]\n",
      " [4.5347176]\n",
      " [4.7274   ]\n",
      " [4.738805 ]\n",
      " [4.8023715]\n",
      " [4.8049493]\n",
      " [4.738805 ]\n",
      " [4.288304 ]\n",
      " [4.288304 ]\n",
      " [4.7282195]\n",
      " [4.555725 ]\n",
      " [4.442723 ]\n",
      " [4.442723 ]\n",
      " [4.442723 ]\n",
      " [4.442723 ]\n",
      " [4.288304 ]\n",
      " [5.0867825]\n",
      " [5.0867825]]\n"
     ]
    }
   ],
   "source": [
    "print(well)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "4a686ba5-d922-463f-998f-c3d5735e6fd9",
   "metadata": {},
   "outputs": [],
   "source": [
    "min_length = min(len(smiles_list_test), len(well))\n",
    "values = [val[0] for val in well[:min_length]] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "01c31e74-a86e-49b2-b9df-385ff644dca7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[5.320606, 5.2716703, 5.059407, 5.1448517, 5.284195, 5.2422705, 5.368682, 5.3890457, 5.09416, 5.0523124, 5.008095, 5.4924116, 5.317238, 5.3535748, 5.489856, 5.3856745, 5.1945477, 4.9230795, 4.5703797, 5.1945477, 5.310707, 5.5732174, 5.90456, 5.951708, 4.988575, 5.777872, 5.2126884, 5.6973, 5.5732174, 5.0983877, 5.310707, 5.2226267, 5.569541, 5.7737846, 5.7737846, 5.859026, 5.4277925, 5.4277925, 5.310707, 5.0386257, 5.4612246, 6.0134506, 5.2927275, 5.2927275, 5.5598526, 5.5598526, 5.412199, 5.412199, 5.3541775, 5.3541775, 5.570532, 5.310707, 5.586858, 5.717229, 5.4824514, 5.656699, 5.656699, 5.3782187, 5.154785, 5.310707, 5.636894, 5.568618, 5.568618, 5.656699, 5.310707, 5.310707, 5.8662004, 5.8747177, 5.5087624, 5.689556, 5.6969585, 5.932081, 5.8662004, 5.656699, 5.322341, 5.511917, 5.7902985, 5.7984476, 5.656699, 5.8204584, 5.5533333, 5.5153084, 6.170492, 5.656699, 6.170492, 6.1144114, 5.310707, 5.8597145, 5.329629, 5.310707, 5.777872, 5.8662004, 5.777872, 5.819627, 5.3081512, 5.81073, 5.81073, 5.8633804, 5.777872, 5.7191763, 5.777872, 5.722163, 5.819627, 5.777872, 5.6903343, 5.7040815, 5.82712, 5.858508, 6.210511, 5.159464, 5.2929363, 6.1123486, 5.2422705, 5.932081, 5.2166834, 5.777872, 5.2166834, 5.2166834, 5.148247, 4.5954304, 4.5954304, 5.969017, 5.148247, 5.995263, 5.148247, 4.5954304, 5.2166834, 5.2166834, 4.69218, 4.846346, 5.858508, 4.8939314, 5.074649, 4.761406, 4.372012, 4.808857, 4.9023666, 4.80898, 4.5442076, 4.4102573, 4.775042, 4.4092307, 4.462623, 4.952179, 5.127536, 4.6680193, 4.9023666, 4.9013677, 4.462623, 4.3791895, 5.30056, 4.8447943, 4.8447943, 4.9308953, 4.894613, 4.936644, 5.114984, 4.4130044, 5.1169605, 5.1169605, 4.462623, 4.287398, 4.4563904, 4.514545, 4.7014904, 4.81493, 4.462623, 4.598121, 4.8791246, 4.764301, 5.1833744, 4.736542, 4.7995963, 4.639909, 6.1021833, 4.663885, 4.5040636, 6.099784, 4.584469, 6.181488, 4.686024, 4.936644, 6.2049227, 4.511265, 6.132676, 6.2354155, 4.7717447, 4.6545105, 5.036561, 4.5309515, 4.437344, 4.560497, 4.353427, 4.7147365, 5.0744343, 4.7623076, 4.96094, 4.6688447, 4.662233, 5.137554, 5.137554, 4.7117896, 4.6879983, 4.4249716, 4.5875573, 4.72059, 4.491992, 4.5525494, 4.72059, 4.685781, 4.9795446, 4.537063, 4.7474356, 4.7474356, 4.210187, 4.210187, 4.6013193, 4.6013193, 4.9672966, 4.598905, 4.598905, 4.795403, 4.795403, 4.491992, 4.3602347, 4.5604734, 4.883171, 4.883171, 4.717496, 4.885735, 4.885735, 4.7076464, 4.7076464, 4.6885495, 4.7441974, 4.834374, 4.8066473, 4.8066473, 4.835931, 4.480832, 4.5871286, 4.6804814, 4.6804814, 4.5366178, 4.7556086, 5.014467, 4.8342733, 4.525578, 4.680826, 4.555725, 4.9001956, 4.922795, 4.922795, 4.81493, 4.4441743, 4.841322, 4.8619003, 4.9672966, 4.5604734, 4.4746227, 4.462974, 4.4292645, 4.7282076, 4.6118264, 4.8006296, 4.99917, 4.6403127, 4.6403127, 4.5070257, 4.6245437, 4.547695, 4.5387697, 4.7893066, 4.581808, 4.56289, 4.644384, 4.3093224, 4.5347176, 4.5347176, 4.5347176, 4.5347176, 4.7274, 4.738805, 4.8023715, 4.8049493, 4.738805, 4.288304, 4.288304, 4.7282195, 4.555725, 4.442723, 4.442723, 4.442723, 4.442723, 4.288304, 5.0867825, 5.0867825]\n"
     ]
    }
   ],
   "source": [
    "print(values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "104815fc-f060-4749-97ab-b400c19635cd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CSV file created successfully!\n"
     ]
    }
   ],
   "source": [
    "# Write to CSV file\n",
    "with open(\"mers_prediction_preliminary.csv\", \"w\", newline=\"\") as file:\n",
    "    writer = csv.writer(file)\n",
    "    writer.writerow([\"SMILES\", \"MERS\"])\n",
    "    for smiles, value in zip(smiles_list_test, values):\n",
    "        writer.writerow([smiles, value])\n",
    "\n",
    "print(\"CSV file created successfully!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "24cb48a8-86f9-43e5-ad8b-74e039158387",
   "metadata": {},
   "source": [
    "The End."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
